generator client {
  provider = "prisma-client-js"
  output   = "../generated/prisma"
}

datasource db {
  provider = "sqlite"
  url      = env("DATABASE_URL")
}

model Company {
  id                 Int          @id @default(autoincrement())
  name               String
  nameEn             String?
  commercialRegister String?
  taxId              String?
  insuranceNumber    String?
  address            String?
  addressEn          String?
  governorateId      Int?
  city               String?
  country            String?
  postalCode         String?
  phone              String?
  phone2             String?
  fax                String?
  mobile             String?
  email              String?
  email2             String?
  website            String?
  facebook           String?
  twitter            String?
  linkedin           String?
  instagram          String?
  logo               String?
  description        String?
  establishedYear    Int?
  legalForm          String?
  capital            Float?
  currency           String?
  bankAccounts       Json?
  taxOffice          String?
  taxRecord          String?
  chamberOfCommerce  String?
  ceo                String?
  ceoPhone           String?
  accountant         String?
  accountantPhone    String?
  notes              String?
  isActive           Boolean      @default(true)
  createdAt          DateTime     @default(now())
  updatedAt          DateTime     @updatedAt
  createdBy          Int?
  updatedBy          Int?
  timezone           String?      @default("Africa/Cairo")
  Branch             Branch[]
  governorate        Governorate? @relation("CompanyGovernorate", fields: [governorateId], references: [id])
  equipment          Equipment[]
  employees          Employee[]
  Project            Project[]

  @@index([isActive])
  @@index([name])
  @@index([createdBy])
  @@index([updatedBy])
  @@index([establishedYear])
  @@index([legalForm])
  @@index([governorateId])
  @@index([city])
  @@index([country])
  @@index([createdAt])
  @@index([name, isActive])
}

model Branch {
  id           Int       @id @default(autoincrement())
  companyId    Int
  name         String
  code         String?
  address      String?
  city         String?
  region       String?
  phone        String?
  mobile       String?
  email        String?
  manager      String?
  managerPhone String?
  type         String?
  capacity     Int?
  openingDate  DateTime?
  isActive     Boolean   @default(true)
  notes        String?
  createdAt    DateTime  @default(now())
  updatedAt    DateTime  @updatedAt
  createdBy    Int?
  updatedBy    Int?
  addressEn    String?
  country      String?
  email2       String?
  fax          String?
  nameEn       String?
  phone2       String?
  postalCode   String?
  website      String?
  Company      Company   @relation(fields: [companyId], references: [id], onDelete: Cascade)

  @@index([isActive])
  @@index([name])
  @@index([companyId])
  @@index([createdBy])
  @@index([updatedBy])
  @@index([type])
  @@index([capacity])
  @@index([city])
  @@index([country])
  @@index([createdAt])
  @@index([companyId, isActive])
}

model Project {
  id                    Int               @id @default(autoincrement())
  companyId             Int
  name                  String
  code                  String?
  description           String?
  clientName            String?
  clientPhone           String?
  clientEmail           String?
  location              String?
  city                  String?
  region                String?
  contractValue         Float?
  currency              String?
  paidAmount            Float?
  remainingAmount       Float?
  startDate             DateTime?
  endDate               DateTime?
  actualEndDate         DateTime?
  projectManager        String?
  engineer              String?
  supervisor            String?
  status                String?
  progress              Int?
  priority              String?
  type                  String?
  category              String?
  isActive              Boolean           @default(true)
  notes                 String?
  createdAt             DateTime          @default(now())
  updatedAt             DateTime          @updatedAt
  createdBy             Int?
  updatedBy             Int?
  descriptionEn         String?
  nameEn                String?
  equipmentInUse        Equipment[]       @relation("ProjectEquipment")
  shiftAssignments      ShiftAssignment[]
  equipmentUsageRecords EquipmentUsage[]
  
  // ğŸ”— Ù†Ø¸Ø§Ù… Ø§Ù„Ù…Ø®Ø§Ø²Ù† Ø§Ù„Ù…ÙˆØ­Ø¯ - Unified Inventory System
  inventoryTransactions INV_Transaction[]      @relation("SparePartTransactionProject")
  sparePartUsages       INV_SparePartUsage[]   @relation("SparePartUsageProject")
  
  Company               Company           @relation(fields: [companyId], references: [id], onDelete: Cascade)

  @@index([endDate])
  @@index([startDate])
  @@index([isActive])
  @@index([status])
  @@index([name])
  @@index([companyId])
  @@index([createdBy])
  @@index([updatedBy])
  @@index([priority])
  @@index([type])
  @@index([category])
  @@index([city])
  @@index([region])
  @@index([createdAt])
  @@index([companyId, isActive])
}

model User {
  id                                       Int                      @id @default(autoincrement())
  telegramId                               BigInt                   @unique
  username                                 String?                  @unique
  fullName                                 String?
  nickname                                 String?
  phone                                    String?
  email                                    String?
  role                                     Role                     @default(GUEST)
  isActive                                 Boolean                  @default(true)
  isBanned                                 Boolean                  @default(false)
  bannedAt                                 DateTime?
  bannedReason                             String?
  bannedBy                                 Int?
  customPermissions                        Json?
  department                               String?
  position                                 String?
  notes                                    String?
  lastActiveAt                             DateTime?                @updatedAt
  createdAt                                DateTime                 @default(now())
  updatedAt                                DateTime                 @updatedAt
  JoinRequest_JoinRequest_userIdToUser     JoinRequest?             @relation("JoinRequest_userIdToUser")
  JoinRequest_JoinRequest_rejectedByToUser JoinRequest[]            @relation("JoinRequest_rejectedByToUser")
  JoinRequest_JoinRequest_approvedByToUser JoinRequest[]            @relation("JoinRequest_approvedByToUser")
  notificationPreferences                  NotificationPreferences?
  receivedNotifications                    NotificationRecipient[]
  createdTemplates                         NotificationTemplate[]   @relation("TemplateCreator")
  roleChangedBy                            RoleChange[]             @relation("ChangedByUser")
  roleChanges                              RoleChange[]             @relation("UserRoleChanges")
  auditLogs                                AuditLog[]               @relation("UserAuditLogs")
  assignedDepartments                      DepartmentAdmin[]        @relation("UserDepartments")
  assignedSubFeatures                      SubFeatureAdmin[]        @relation("UserSubFeatures")

  @@index([isActive])
  @@index([role])
  @@index([telegramId])
  @@index([username])
  @@index([bannedBy])
  @@index([department])
  @@index([position])
  @@index([lastActiveAt])
  @@index([email])
  @@index([phone])
  @@index([createdAt])
  @@index([role, isActive])
}

model JoinRequest {
  id                                Int           @id @default(autoincrement())
  telegramId                        BigInt        @unique
  username                          String?
  fullName                          String
  nickname                          String?
  phone                             String
  status                            RequestStatus @default(PENDING)
  requestedAt                       DateTime      @default(now())
  respondedAt                       DateTime?
  approvedBy                        Int?
  rejectedBy                        Int?
  rejectionReason                   String?
  notes                             String?
  userId                            Int?          @unique
  User_JoinRequest_userIdToUser     User?         @relation("JoinRequest_userIdToUser", fields: [userId], references: [id])
  User_JoinRequest_rejectedByToUser User?         @relation("JoinRequest_rejectedByToUser", fields: [rejectedBy], references: [id])
  User_JoinRequest_approvedByToUser User?         @relation("JoinRequest_approvedByToUser", fields: [approvedBy], references: [id])

  @@index([requestedAt])
  @@index([status])
  @@index([telegramId])
  @@index([approvedBy])
  @@index([rejectedBy])
  @@index([respondedAt])
  @@index([fullName])
  @@index([phone])
  @@index([nickname])
  @@index([status, requestedAt])
}

model RoleChange {
  id            Int      @id @default(autoincrement())
  userId        Int
  oldRole       Role
  newRole       Role
  changedBy     Int
  reason        String?
  createdAt     DateTime @default(now())
  changedByUser User     @relation("ChangedByUser", fields: [changedBy], references: [id])
  user          User     @relation("UserRoleChanges", fields: [userId], references: [id], onDelete: Cascade)

  @@index([changedBy])
  @@index([userId])
  @@index([createdAt])
  @@index([oldRole])
  @@index([newRole])
  @@index([reason])
  @@index([changedBy, createdAt])
  @@index([userId, createdAt])
  @@index([oldRole, newRole])
}

model Permission {
  id          Int      @id @default(autoincrement())
  name        String   @unique
  description String?
  category    String?
  isActive    Boolean  @default(true)
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  @@index([category])
  @@index([isActive])
  @@index([name])
  @@index([createdAt])
  @@index([updatedAt])
  @@index([category, isActive])
  @@index([name, isActive])
}

model NotificationPreferences {
  id                Int      @id @default(autoincrement())
  userId            Int      @unique
  enabled           Boolean  @default(true)
  types             Json?
  priorities        Json?
  quietHoursEnabled Boolean  @default(false)
  quietHoursStart   String?
  quietHoursEnd     String?
  channels          Json?
  createdAt         DateTime @default(now())
  updatedAt         DateTime @updatedAt
  user              User     @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([userId])
  @@index([enabled])
  @@index([quietHoursEnabled])
  @@index([createdAt])
  @@index([updatedAt])
  @@index([userId, enabled])
  @@index([enabled, quietHoursEnabled])
}

model Notification {
  id              String                  @id
  message         String
  type            NotificationType        @default(INFO)
  priority        NotificationPriority    @default(NORMAL)
  status          GeneralStatus           @default(PENDING)
  targetAudience  String
  targetRole      String?
  targetUserIds   Json?
  data            Json?
  buttons         Json?
  image           String?
  parseMode       String?                 @default("HTML")
  scheduledAt     DateTime?
  sentAt          DateTime?
  recurring       Boolean                 @default(false)
  recurringConfig Json?
  templateId      String?
  failureReason   String?
  successCount    Int                     @default(0)
  failureCount    Int                     @default(0)
  metadata        Json?
  createdAt       DateTime                @default(now())
  updatedAt       DateTime                @updatedAt
  recipients      NotificationRecipient[]

  @@index([status])
  @@index([type])
  @@index([priority])
  @@index([targetAudience])
  @@index([scheduledAt])
  @@index([sentAt])
  @@index([createdAt])
  @@index([templateId])
  @@index([status, createdAt])
  @@index([type, priority])
}

model NotificationRecipient {
  id             Int           @id @default(autoincrement())
  notificationId String
  userId         Int
  status         GeneralStatus @default(PENDING)
  sentAt         DateTime?
  failureReason  String?
  createdAt      DateTime      @default(now())
  updatedAt      DateTime      @updatedAt
  user           User          @relation(fields: [userId], references: [id], onDelete: Cascade)
  notification   Notification  @relation(fields: [notificationId], references: [id], onDelete: Cascade)

  @@unique([notificationId, userId])
  @@index([notificationId])
  @@index([userId])
  @@index([status])
  @@index([sentAt])
  @@index([createdAt])
  @@index([failureReason])
  @@index([updatedAt])
  @@index([notificationId, status])
  @@index([userId, status])
}

model NotificationTemplate {
  id        String               @id @default(cuid())
  name      String               @unique
  message   String
  type      NotificationType     @default(INFO)
  priority  NotificationPriority @default(NORMAL)
  variables Json?
  buttons   Json?
  isActive  Boolean              @default(true)
  createdBy Int?
  createdAt DateTime             @default(now())
  updatedAt DateTime             @updatedAt
  creator   User?                @relation("TemplateCreator", fields: [createdBy], references: [id])

  @@index([isActive])
  @@index([type])
  @@index([priority])
  @@index([createdBy])
  @@index([name])
  @@index([createdAt])
  @@index([updatedAt])
  @@index([isActive, type])
  @@index([type, priority])
}

model Setting {
  id          Int             @id @default(autoincrement())
  key         String
  value       String
  scope       SettingScope    @default(GLOBAL)
  category    SettingCategory @default(SYSTEM)
  type        SettingType
  userId      Int?            @default(0)
  featureId   String?         @default("")
  description String?
  isSecret    Boolean         @default(false)
  createdAt   DateTime        @default(now())
  updatedAt   DateTime        @updatedAt
  updatedBy   Int?

  @@unique([key, scope, userId, featureId])
  @@index([featureId])
  @@index([userId])
  @@index([category])
  @@index([scope])
  @@index([key])
  @@index([updatedBy])
  @@index([isSecret])
  @@index([createdAt])
  @@index([updatedAt])
  @@index([category, scope])
  @@index([key, scope])
}

model Department {
  id          Int        @id @default(autoincrement())
  name        String
  nameEn      String?
  code        String     @unique
  description String?
  managerId   Int?
  orderIndex  Int        @default(0)
  isActive    Boolean    @default(true)
  createdAt   DateTime   @default(now())
  updatedAt   DateTime   @updatedAt
  createdBy   Int?
  updatedBy   Int?
  employees   Employee[]
  positions   Position[]

  @@index([code])
  @@index([isActive])
  @@index([orderIndex])
  @@index([name])
  @@index([createdAt])
  @@map("HR_Department")
}

model Position {
  id                       Int        @id @default(autoincrement())
  title                    String
  titleAr                  String
  code                     String     @unique
  description              String?
  departmentId             Int
  orderIndex               Int        @default(0)
  isActive                 Boolean    @default(true)
  defaultWorkDaysPerCycle  Int?
  defaultLeaveDaysPerCycle Int?
  createdAt                DateTime   @default(now())
  updatedAt                DateTime   @updatedAt
  createdBy                Int?
  updatedBy                Int?
  employees                Employee[]
  department               Department @relation(fields: [departmentId], references: [id])

  // Ù†Ø¸Ø§Ù… Ø§Ù„Ø±ÙˆØ§ØªØ¨ Ø§Ù„Ø¬Ø¯ÙŠØ¯
  positionAllowances HR_PositionAllowance[] @relation("PositionAllowances")

  @@index([code])
  @@index([departmentId])
  @@index([isActive])
  @@index([title])
  @@index([titleAr])
  @@index([createdAt])
  @@map("HR_Position")
}

model Governorate {
  id         Int        @id @default(autoincrement())
  nameAr     String     @unique
  nameEn     String     @unique
  code       String     @unique
  region     String?
  orderIndex Int        @default(0)
  isActive   Boolean    @default(true)
  createdAt  DateTime   @default(now())
  updatedAt  DateTime   @updatedAt
  companies  Company[]  @relation("CompanyGovernorate")
  employees  Employee[] @relation("EmployeeGovernorate")

  @@index([nameAr])
  @@index([nameEn])
  @@index([code])
  @@index([isActive])
  @@index([orderIndex])
  @@index([region])
  @@map("Location_Governorate")
}

model Employee {
  id                       Int                   @id @default(autoincrement())
  employeeCode             String                @unique
  fullName                 String
  fullNameEn               String?
  nickname                 String?
  nationalId               String                @unique
  passportNumber           String?
  gender                   Gender
  dateOfBirth              DateTime
  placeOfBirth             String?
  nationality              String
  maritalStatus            MaritalStatus
  religion                 String?
  bloodType                String?
  personalEmail            String?
  workEmail                String?
  personalPhone            String
  workPhone                String?
  telegramId               String?
  emergencyContactName     String
  emergencyContactPhone    String
  emergencyContactRelation String?
  currentAddress           String
  currentAddressEn         String?
  permanentAddress         String?
  governorateId            Int?
  city                     String
  region                   String?
  country                  String                @default("Egypt")
  postalCode               String?
  companyId                Int
  departmentId             Int
  positionId               Int
  employmentType           EmploymentType
  contractType             ContractType
  employmentStatus         EmploymentStatus      @default(ACTIVE)
  hireDate                 DateTime
  confirmationDate         DateTime?
  resignationDate          DateTime?
  terminationDate          DateTime?
  terminationReason        String?
  basicSalary              Float
  allowances               Float?                @default(0)
  totalSalary              Float
  currency                 String                @default("EGP")
  paymentMethod            PaymentMethod         @default(BANK_TRANSFER)
  bankName                 String?
  bankAccountNumber        String?
  iban                     String?
  transferNumber1          String?
  transferType1            TransferType?
  transferNumber2          String?
  transferType2            TransferType?
  socialInsuranceNumber    String?
  taxNumber                String?
  insuranceStartDate       DateTime?
  salaryCalculationType    SalaryCalculationType @default(MONTHLY)
  directManagerId          Int?
  workSchedule             String?
  workLocation             String?
  educationLevel           EducationLevel?
  major                    String?
  university               String?
  graduationYear           Int?
  yearsOfExperience        Int?                  @default(0)
  profilePhoto             String?
  cv                       String?
  nationalIdCardUrl        String?
  annualLeaveBalance       Int                   @default(21)
  sickLeaveBalance         Int                   @default(180)
  casualLeaveBalance       Int                   @default(7)
  attendanceRequired       Boolean               @default(false)
  workDaysPerCycle         Int?
  leaveDaysPerCycle        Int?
  hasCustomCycle           Boolean               @default(false)
  currentWorkDays          Int?                  @default(0)
  currentLeaveDays         Int?                  @default(0)
  lastLeaveStartDate       DateTime?
  lastLeaveEndDate         DateTime?
  nextLeaveStartDate       DateTime?
  nextLeaveEndDate         DateTime?
  isOnLeave                Boolean               @default(false)
  isOnMission              Boolean               @default(false)
  currentLeaveId           Int?
  currentMissionId         Int?
  totalLeaveDays           Int                   @default(0)
  totalDelayDays           Int                   @default(0)
  fingerprintId            String?
  notes                    String?
  isActive                 Boolean               @default(true)
  createdAt                DateTime              @default(now())
  updatedAt                DateTime              @updatedAt
  createdBy                Int?
  updatedBy                Int?

  operatedEquipment    Equipment[]              @relation("EquipmentOperator")
  fuelLogs             FuelLog[]                @relation("FuelOperator")
  performedMaintenance MaintenanceRecord[]      @relation("MaintenancePerformer")
  shiftAssignments     ShiftAssignment[]        @relation("ShiftOperator")
  equipmentUsages      EquipmentUsage[]         @relation("UsageOperator")
  directManager        Employee?                @relation("ManagerSubordinates", fields: [directManagerId], references: [id])
  subordinates         Employee[]               @relation("ManagerSubordinates")
  position             Position                 @relation(fields: [positionId], references: [id])
  department           Department               @relation(fields: [departmentId], references: [id])
  company              Company                  @relation(fields: [companyId], references: [id])
  governorate          Governorate?             @relation("EmployeeGovernorate", fields: [governorateId], references: [id])
  leaveReplacements    HR_EmployeeLeave[]       @relation("LeaveReplacements")
  leaves               HR_EmployeeLeave[]       @relation("EmployeeLeaves")
  missions             HR_EmployeeMission[]     @relation("EmployeeMissions")
  leaveAllowances      HR_LeaveAllowance[]      @relation("EmployeeAllowances")
  transactions         HR_Transaction[]         @relation("EmployeeTransactions")

  // Ù†Ø¸Ø§Ù… Ø§Ù„Ø±ÙˆØ§ØªØ¨ Ø§Ù„Ø¬Ø¯ÙŠØ¯
  employeeAllowances HR_EmployeeAllowance[] @relation("EmployeeAllowances")
  payrollRecords     HR_PayrollRecord[]     @relation("EmployeePayrollRecords")
  monthlyPayrolls    HR_MonthlyPayroll[]    @relation("EmployeeMonthlyPayrolls")

  // Ù†Ø¸Ø§Ù… Ø¹Ù‚ÙˆØ¨Ø§Øª Ø§Ù„ØªØ£Ø®ÙŠØ±
  appliedPenalties HR_AppliedPenalty[] @relation("EmployeeAppliedPenalties")

  // ğŸ”— Ù†Ø¸Ø§Ù… Ø§Ù„Ù…Ø®Ø§Ø²Ù† Ø§Ù„Ù…ÙˆØ­Ø¯ - Unified Inventory System
  responsibleItems       INV_Item[]            @relation("SparePartResponsible")
  recipientTransactions  INV_Transaction[]     @relation("RecipientEmployee")
  returnTransactions     INV_Transaction[]     @relation("ReturnedByEmployee")
  sparePartInstallations INV_SparePartUsage[]  @relation("SparePartUsageInstaller")

  skills         Skill[]
  certifications Certification[]
  documents      Document[]
  workHistory    WorkExperience[]

  @@index([employeeCode])
  @@index([nationalId])
  @@index([companyId])
  @@index([departmentId])
  @@index([positionId])
  @@index([directManagerId])
  @@index([employmentStatus])
  @@index([employmentType])
  @@index([isActive])
  @@index([hireDate])
  @@index([fullName])
  @@index([nickname])
  @@index([gender])
  @@index([maritalStatus])
  @@index([governorateId])
  @@index([city])
  @@index([country])
  @@index([createdAt])
  @@index([companyId, departmentId])
  @@index([companyId, isActive])
  @@index([departmentId, isActive])
  @@index([employmentStatus, isActive])
  @@map("HR_Employee")
}

model Skill {
  id        Int        @id @default(autoincrement())
  name      String     @unique
  employees Employee[]

  @@map("HR_Skill")
}

model Document {
  id         Int      @id @default(autoincrement())
  name       String
  url        String
  type       String
  employeeId Int
  employee   Employee @relation(fields: [employeeId], references: [id], onDelete: Cascade)

  @@index([employeeId])
  @@map("HR_Document")
}

model Certification {
  id           Int       @id @default(autoincrement())
  name         String
  issuingOrg   String
  issueDate    DateTime
  expiryDate   DateTime?
  credentialId String?
  url          String?
  employeeId   Int
  employee     Employee  @relation(fields: [employeeId], references: [id], onDelete: Cascade)

  @@index([employeeId])
  @@map("HR_Certification")
}

model WorkExperience {
  id          Int       @id @default(autoincrement())
  companyName String
  position    String
  startDate   DateTime
  endDate     DateTime?
  description String?
  employeeId  Int
  employee    Employee  @relation(fields: [employeeId], references: [id], onDelete: Cascade)

  @@index([employeeId])
  @@map("HR_WorkExperience")
}

model HR_EmployeeLeave {
  id                Int                 @id @default(autoincrement())
  leaveNumber       String              @unique
  employeeId        Int
  leaveType         LeaveType           @default(REGULAR)
  settlementType    LeaveSettlementType @default(ACTUAL_LEAVE) // Ù†ÙˆØ¹ Ø§Ù„ØªØ³ÙˆÙŠØ©: ÙØ¹Ù„ÙŠØ© Ø£Ùˆ Ù†Ù‚Ø¯ÙŠØ©
  startDate         DateTime
  endDate           DateTime
  totalDays         Int
  reason            String?
  status            GeneralStatus       @default(PENDING)
  isActive          Boolean             @default(true)
  actualReturnDate  DateTime?
  delayDays         Int                 @default(0)
  isPostponed       Boolean             @default(false)
  postponedTimes    Int                 @default(0)
  allowanceAmount   Float?              // Ù…Ø¨Ù„Øº Ø§Ù„Ø¨Ø¯Ù„ Ø§Ù„Ù†Ù‚Ø¯ÙŠ (Ù„Ù„ØªØ³ÙˆÙŠØ© Ø§Ù„Ù†Ù‚Ø¯ÙŠØ©)
  allowanceSettled  Boolean             @default(false)
  allowancePaidDate DateTime?           // ØªØ§Ø±ÙŠØ® ØµØ±Ù Ø§Ù„Ø¨Ø¯Ù„
  medicalReportPath String?
  affectsNextLeave  Boolean             @default(true)
  replacementId     Int?
  approvedBy        Int?
  approvedAt        DateTime?
  rejectionReason   String?
  createdAt         DateTime            @default(now())
  updatedAt         DateTime            @updatedAt
  replacement       Employee?     @relation("LeaveReplacements", fields: [replacementId], references: [id])
  employee          Employee      @relation("EmployeeLeaves", fields: [employeeId], references: [id], onDelete: Cascade)

  // Ø§Ù„Ø¹Ù‚ÙˆØ¨Ø§Øª Ø§Ù„Ù…Ø·Ø¨Ù‚Ø© Ø¹Ù„Ù‰ Ù‡Ø°Ù‡ Ø§Ù„Ø¥Ø¬Ø§Ø²Ø©
  appliedPenalties HR_AppliedPenalty[] @relation("LeaveAppliedPenalties")

  @@index([employeeId])
  @@index([leaveNumber])
  @@index([leaveType])
  @@index([status])
  @@index([isActive])
  @@index([startDate, endDate])
  @@index([employeeId, isActive])
}

// ============================================
// Ù†Ø¸Ø§Ù… Ø§Ù„Ø±ÙˆØ§ØªØ¨ ÙˆØ§Ù„Ø£Ø¬ÙˆØ± - Payroll System
// ============================================

// 1ï¸âƒ£ Ø£Ù†ÙˆØ§Ø¹ Ø§Ù„Ø¨Ø¯Ù„Ø§Øª (Allowance Types)
model HR_AllowanceType {
  id                 Int                    @id @default(autoincrement())
  code               String                 @unique // "TRANSPORT", "VACATION", "OVERTIME", "OTHER"
  nameAr             String // "Ø¨Ø¯Ù„ Ø§Ù†ØªÙ‚Ø§Ù„"
  nameEn             String? // "Transportation Allowance"
  description        String?
  isActive           Boolean                @default(true)
  orderIndex         Int                    @default(0)
  createdAt          DateTime               @default(now())
  updatedAt          DateTime               @updatedAt
  positionAllowances HR_PositionAllowance[]
  employeeAllowances HR_EmployeeAllowance[]

  @@index([code])
  @@index([isActive])
  @@index([orderIndex])
  @@map("HR_AllowanceType")
}

// 2ï¸âƒ£ Ø¨Ø¯Ù„Ø§Øª Ø§Ù„ÙˆØ¸Ø§Ø¦Ù (Position Allowances) - Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ
model HR_PositionAllowance {
  id              Int              @id @default(autoincrement())
  positionId      Int
  allowanceTypeId Int
  amount          Float // Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ø´Ù‡Ø±ÙŠ
  isActive        Boolean          @default(true)
  notes           String?
  createdAt       DateTime         @default(now())
  updatedAt       DateTime         @updatedAt
  createdBy       BigInt?
  updatedBy       BigInt?
  position        Position         @relation("PositionAllowances", fields: [positionId], references: [id], onDelete: Cascade)
  allowanceType   HR_AllowanceType @relation(fields: [allowanceTypeId], references: [id])

  @@unique([positionId, allowanceTypeId])
  @@index([positionId])
  @@index([allowanceTypeId])
  @@index([isActive])
  @@map("HR_PositionAllowance")
}

// 3ï¸âƒ£ Ø¨Ø¯Ù„Ø§Øª Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ† (Employee Allowances) - Ø§Ø³ØªØ«Ù†Ø§Ø¡Ø§Øª Ø®Ø§ØµØ©
model HR_EmployeeAllowance {
  id               Int              @id @default(autoincrement())
  employeeId       Int
  allowanceTypeId  Int
  amount           Float // Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ø´Ù‡Ø±ÙŠ
  overridePosition Boolean          @default(true) // ÙŠÙ„ØºÙŠ Ø¨Ø¯Ù„ Ø§Ù„ÙˆØ¸ÙŠÙØ©
  startDate        DateTime? // ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¨Ø¯Ø§ÙŠØ©
  endDate          DateTime? // ØªØ§Ø±ÙŠØ® Ø§Ù„Ù†Ù‡Ø§ÙŠØ© (NULL = Ø¯Ø§Ø¦Ù…)
  isActive         Boolean          @default(true)
  reason           String? // Ø³Ø¨Ø¨ Ø§Ù„Ø¨Ø¯Ù„ Ø§Ù„Ø®Ø§Øµ
  notes            String?
  createdAt        DateTime         @default(now())
  updatedAt        DateTime         @updatedAt
  createdBy        BigInt?
  updatedBy        BigInt?
  employee         Employee         @relation("EmployeeAllowances", fields: [employeeId], references: [id], onDelete: Cascade)
  allowanceType    HR_AllowanceType @relation(fields: [allowanceTypeId], references: [id])

  @@index([employeeId])
  @@index([allowanceTypeId])
  @@index([isActive])
  @@index([startDate, endDate])
  @@map("HR_EmployeeAllowance")
}

// 4ï¸âƒ£ Ø§Ø³ØªØ­Ù‚Ø§Ù‚Ø§Øª Ø§Ù„Ù…Ø³Ø­ÙˆØ¨Ø§Øª Ø§Ù„Ø¹ÙŠÙ†ÙŠØ© (Material Entitlements)
model HR_MaterialEntitlement {
  id            Int            @id @default(autoincrement())
  targetType    String // "POSITION" Ø£Ùˆ "EMPLOYEE"
  targetId      Int // positionId Ø£Ùˆ employeeId
  itemId        Int // Ù…Ø¹Ø±Ù Ø§Ù„ØµÙ†Ù Ù…Ù† HR_AdvanceItem
  dailyQuantity Float // Ø§Ù„ÙƒÙ…ÙŠØ© Ø§Ù„Ù…Ø³ØªØ­Ù‚Ø© ÙŠÙˆÙ…ÙŠØ§Ù‹
  isActive      Boolean        @default(true)
  notes         String?
  createdAt     DateTime       @default(now())
  updatedAt     DateTime       @updatedAt
  createdBy     BigInt?
  updatedBy     BigInt?
  item          HR_AdvanceItem @relation("ItemEntitlements", fields: [itemId], references: [id])

  @@unique([targetType, targetId, itemId])
  @@index([targetType, targetId])
  @@index([itemId])
  @@index([isActive])
  @@map("HR_MaterialEntitlement")
}

// 5ï¸âƒ£ Ø§Ù„Ù…ÙƒØ§ÙØ¢Øª Ø§Ù„Ø´Ù‡Ø±ÙŠØ© (Monthly Bonuses)
model HR_Bonus {
  id             Int       @id @default(autoincrement())
  bonusType      String // "INDIVIDUAL" (Ù…ÙˆØ¸Ù), "POSITION" (ÙˆØ¸ÙŠÙØ©), "ALL" (Ø§Ù„ÙƒÙ„)
  targetId       Int? // employeeId Ø£Ùˆ positionId (NULL Ù„Ù„ÙƒÙ„)
  bonusName      String // Ø§Ø³Ù… Ø§Ù„Ù…ÙƒØ§ÙØ£Ø© (Ù…Ø±Ù†): "Ø¥Ø¶Ø§ÙÙŠ"ØŒ "Ù…ÙƒØ§ÙØ£Ø© Ù…Ø¬Ù‡ÙˆØ¯Ø§Øª"ØŒ "Ø¨Ø¯Ù„ ØªÙ…ÙŠØ²"ØŒ Ø¥Ù„Ø®
  amount         Float
  description    String? // ÙˆØµÙ Ø¥Ø¶Ø§ÙÙŠ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)
  startDate      DateTime // ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¨Ø¯Ø§ÙŠØ©
  durationMonths Int? // Ø¹Ø¯Ø¯ Ø§Ù„Ø£Ø´Ù‡Ø± (NULL = Ø¯Ø§Ø¦Ù…ØŒ 1 = Ø´Ù‡Ø± ÙˆØ§Ø­Ø¯ØŒ 2 = Ø´Ù‡Ø±ÙŠÙ†ØŒ Ø¥Ù„Ø®)
  isActive       Boolean   @default(true)
  notes          String? // Ù…Ù„Ø§Ø­Ø¸Ø§Øª
  createdAt      DateTime  @default(now())
  updatedAt      DateTime  @updatedAt
  createdBy      BigInt?
  approvedBy     BigInt?
  approvedAt     DateTime?

  @@index([bonusType])
  @@index([targetId])
  @@index([isActive])
  @@index([startDate])
  @@index([durationMonths])
  @@map("HR_Bonus")
}

// Ø³Ø¬Ù„ ÙƒØ´ÙˆÙ Ø§Ù„Ø±ÙˆØ§ØªØ¨ Ø§Ù„Ù…Ø­ÙÙˆØ¸Ø© (Ù„Ù„ØªÙ‚Ø§Ø±ÙŠØ±)
model HR_PayrollRecord {
  id            Int     @id @default(autoincrement())
  employeeId    Int
  employeeCode  String
  employeeName  String
  positionTitle String?

  // Ø§Ù„ÙØªØ±Ø©
  month           Int // 1-12
  year            Int
  periodStartDate DateTime
  periodEndDate   DateTime
  settlementType  String // 'today', 'half_first', 'half_second', 'full_month', 'termination', 'last_leave'

  // Ø£ÙŠØ§Ù… Ø§Ù„Ø¹Ù…Ù„
  totalDays Int // Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø£ÙŠØ§Ù… Ø§Ù„ÙØªØ±Ø©
  workDays  Int // Ø£ÙŠØ§Ù… Ø§Ù„Ø¹Ù…Ù„ Ø§Ù„ÙØ¹Ù„ÙŠØ©
  leaveDays Int @default(0)

  // Ø§Ù„Ù…Ø³ØªØ­Ù‚Ø§Øª
  basicSalary       Float @default(0)
  totalAllowances   Float @default(0)
  totalBonuses      Float @default(0)
  materialAllowance Float @default(0)
  grossSalary       Float // Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø³ØªØ­Ù‚Ø§Øª

  // Ø§Ù„Ø®ØµÙˆÙ…Ø§Øª
  cashAdvances      Float @default(0)
  itemWithdrawals   Float @default(0)
  absenceDeductions Float @default(0)
  otherDeductions   Float @default(0)
  totalDeductions   Float

  // Ø§Ù„Ù†ØªÙŠØ¬Ø©
  netSalary Float // Ø§Ù„ØµØ§ÙÙŠ

  // ØªÙØ§ØµÙŠÙ„ Ø¥Ø¶Ø§ÙÙŠØ© (JSON)
  allowancesDetails Json? // ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø¨Ø¯Ù„Ø§Øª
  bonusesDetails    Json? // ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù…ÙƒØ§ÙØ¢Øª
  deductionsDetails Json? // ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø®ØµÙˆÙ…Ø§Øª

  // Ø­Ø§Ù„Ø© Ø§Ù„Ø³Ø¯Ø§Ø¯
  paymentStatus String    @default("UNPAID") // PAID, UNPAID, PARTIAL
  amountPaid    Float     @default(0) // Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…Ø¯ÙÙˆØ¹ ÙØ¹Ù„ÙŠØ§Ù‹
  paymentDate   DateTime? // ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¯ÙØ¹
  paymentNotes  String? // Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø§Ù„Ø¯ÙØ¹

  // Ø­Ø§Ù„Ø© Ø§Ù„Ø³Ø¬Ù„
  isDeleted    Boolean   @default(false) // Ù„Ù„Ø­Ø°Ù Ø§Ù„Ù…Ù†Ø·Ù‚ÙŠ
  deletedAt    DateTime?
  deletedBy    BigInt?
  deleteReason String?

  // Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„ØªØ³Ø¬ÙŠÙ„
  createdAt DateTime @default(now())
  createdBy BigInt?
  updatedAt DateTime @default(now()) @updatedAt
  updatedBy BigInt?

  employee  Employee             @relation("EmployeePayrollRecords", fields: [employeeId], references: [id], onDelete: Cascade)
  auditLogs HR_PayrollAuditLog[]

  // Ø§Ù„Ø¹Ù‚ÙˆØ¨Ø§Øª Ø§Ù„Ù…Ø·Ø¨Ù‚Ø© Ø¹Ù„Ù‰ Ù‡Ø°Ø§ Ø§Ù„Ø±Ø§ØªØ¨
  appliedPenalties HR_AppliedPenalty[] @relation("PayrollAppliedPenalties")

  @@unique([employeeId, month, year]) // Ù…Ù†Ø¹ Ø§Ù„ØªÙƒØ±Ø§Ø± Ù„Ù†ÙØ³ Ø§Ù„Ù…ÙˆØ¸Ù ÙÙŠ Ù†ÙØ³ Ø§Ù„Ø´Ù‡Ø±
  @@index([employeeId])
  @@index([month, year])
  @@index([createdAt])
  @@index([paymentStatus])
  @@map("HR_PayrollRecord")
}

// Ø³Ø¬Ù„ Ø§Ù„ØªØ¯Ù‚ÙŠÙ‚ Ù„ÙƒØ´ÙˆÙ Ø§Ù„Ø±ÙˆØ§ØªØ¨
model HR_PayrollAuditLog {
  id              Int      @id @default(autoincrement())
  payrollRecordId Int
  action          String // CREATED, UPDATED, DELETED, PAYMENT_UPDATED, PAYMENT_CONFIRMED
  actionBy        BigInt
  actionAt        DateTime @default(now())

  // Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù‚Ø¨Ù„ Ø§Ù„ØªØºÙŠÙŠØ±
  oldData Json?
  // Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ø¹Ø¯ Ø§Ù„ØªØºÙŠÙŠØ±
  newData Json?

  // ØªÙØ§ØµÙŠÙ„ Ø¥Ø¶Ø§ÙÙŠØ©
  changes   Json? // Ø§Ù„ØªØºÙŠÙŠØ±Ø§Øª Ø§Ù„Ù…Ø­Ø¯Ø¯Ø©
  notes     String?
  ipAddress String?

  payrollRecord HR_PayrollRecord @relation(fields: [payrollRecordId], references: [id], onDelete: Cascade)

  @@index([payrollRecordId])
  @@index([actionBy])
  @@index([actionAt])
  @@map("HR_PayrollAuditLog")
}

// Ù†Ø¸Ø§Ù… Ø§Ù„Ø±ÙˆØ§ØªØ¨ Ø§Ù„Ø´Ù‡Ø±ÙŠØ© Ø§Ù„Ø¬Ù…Ø§Ø¹ÙŠ
model HR_MonthlyPayroll {
  id         Int @id @default(autoincrement())
  employeeId Int

  // Ø§Ù„ÙØªØ±Ø©
  month      Int // 1-12
  year       Int
  periodDays Int // Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø£ÙŠØ§Ù… Ø§Ù„Ø´Ù‡Ø±

  // Ø£ÙŠØ§Ù… Ø§Ù„Ø¹Ù…Ù„
  actualWorkDays        Int // Ø£ÙŠØ§Ù… Ø§Ù„Ø¹Ù…Ù„ Ø§Ù„Ù…Ø¯ÙÙˆØ¹Ø©
  workDaysForAllowances Int // Ø£ÙŠØ§Ù… Ø§Ù„Ø¹Ù…Ù„ Ù„Ø­Ø³Ø§Ø¨ Ø§Ù„Ø¨Ø¯Ù„Ø§Øª (Ø¨Ø¯ÙˆÙ† Ø®ØµÙ… Ø¥Ø¬Ø§Ø²Ø§Øª)
  daysBeforeHire        Int @default(0)
  daysAfterTermination  Int @default(0)
  unpaidLeaveDays       Int @default(0)
  paidLeaveDays         Int @default(0)
  delayDays             Int @default(0)
  actualPresenceDays    Int @default(0) // Ø£ÙŠØ§Ù… Ø§Ù„ØªÙˆØ§Ø¬Ø¯ Ø§Ù„ÙØ¹Ù„ÙŠ ÙÙŠ Ø§Ù„Ù…ÙˆÙ‚Ø¹

  // Ø§Ù„Ø±Ø§ØªØ¨ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ
  basicSalary    Float @default(0) // Ø§Ù„Ø±Ø§ØªØ¨ Ø§Ù„Ø´Ù‡Ø±ÙŠ Ø§Ù„Ù…Ø³Ø¬Ù„
  proratedSalary Float @default(0) // Ø§Ù„Ø±Ø§ØªØ¨ Ø¨Ø§Ù„Ù†Ø³Ø¨Ø© ÙˆØ§Ù„ØªÙ†Ø§Ø³Ø¨

  // Ø§Ù„Ø¨Ø¯Ù„Ø§Øª (Ù„Ù„ØªÙˆØ§ÙÙ‚ Ù…Ø¹ Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù‚Ø¯ÙŠÙ…)
  housingAllowance   Float @default(0)
  transportAllowance Float @default(0)
  foodAllowance      Float @default(0)
  fieldAllowance     Float @default(0)
  materialAllowance  Float @default(0)
  totalAllowances    Float @default(0)

  // Ø§Ù„Ù…ÙƒØ§ÙØ¢Øª ÙˆØ¨Ø¯Ù„ Ø§Ù„Ø¥Ø¬Ø§Ø²Ø§Øª
  totalBonuses         Float @default(0)
  totalLeaveAllowances Float @default(0)

  // Ø§Ù„Ø®ØµÙˆÙ…Ø§Øª
  totalAdvances    Float @default(0)
  totalWithdrawals Float @default(0)
  totalDebts       Float @default(0)
  totalDeductions  Float @default(0)

  // Ø§Ù„Ø¹Ù‚ÙˆØ¨Ø§Øª
  totalDelayPenalties Float @default(0)

  // Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠØ§Øª
  totalEarnings Float @default(0) // Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø³ØªØ­Ù‚Ø§Øª
  netSalary     Float @default(0) // ØµØ§ÙÙŠ Ø§Ù„Ø±Ø§ØªØ¨

  // ØªÙØ§ØµÙŠÙ„ Ø¥Ø¶Ø§ÙÙŠØ© (JSON)
  allowancesDetails      Json? // {position: [], employee: [], material: []}
  bonusesDetails         Json? // [{name, type, monthly, actual}]
  leaveAllowancesDetails Json? // [{leaveNumber, days, amount, startDate, endDate}]
  deductionsDetails      Json? // {cashAdvances: [], itemWithdrawals: [], debts: []}
  penaltiesDetails       Json? // [{leaveNumber, delayDays, deductionDays, amount}]

  // Ø­Ø§Ù„Ø© Ø§Ù„Ø¯ÙØ¹
  paymentStatus String    @default("PENDING") // PENDING, PAID, PARTIAL
  amountPaid    Float     @default(0)
  paymentDate   DateTime?
  paymentNotes  String?

  // Ø­Ø§Ù„Ø© Ø§Ù„ØªØ³ÙˆÙŠØ©
  settlementStatus String    @default("PENDING") // PENDING, SETTLED
  settledAt        DateTime?
  settledBy        BigInt?

  // Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„ØªØ³Ø¬ÙŠÙ„
  createdAt       DateTime @default(now())
  createdByUserId BigInt?
  updatedAt       DateTime @default(now()) @updatedAt

  // Ø§Ù„Ø¹Ù„Ø§Ù‚Ø§Øª
  employee Employee @relation("EmployeeMonthlyPayrolls", fields: [employeeId], references: [id], onDelete: Cascade)

  @@unique([employeeId, month, year])
  @@index([employeeId])
  @@index([month, year])
  @@index([createdAt])
  @@index([paymentStatus])
  @@index([settlementStatus])
  @@map("HR_MonthlyPayroll")
}

model EquipmentCategory {
  id          Int             @id @default(autoincrement())
  nameAr      String          @unique
  nameEn      String          @unique
  code        String          @unique
  description String?
  icon        String?
  orderIndex  Int             @default(0)
  isActive    Boolean         @default(true)
  createdAt   DateTime        @default(now())
  updatedAt   DateTime        @updatedAt
  createdBy   Int?
  updatedBy   Int?
  types       EquipmentType[]

  @@index([code])
  @@index([isActive])
  @@index([orderIndex])
  @@map("Equipment_Category")
}

model EquipmentType {
  id                       Int                     @id @default(autoincrement())
  categoryId               Int
  nameAr                   String
  nameEn                   String
  code                     String                  @unique
  description              String?
  defaultCapacity          String?
  defaultFuelType          String?
  requiresLicense          Boolean                 @default(false)
  licenseType              String?
  maintenanceTrackingType  MaintenanceTrackingType @default(HOURS)
  oilChangeInterval        Int?
  maintenanceIntervalDays  Int?
  maintenanceIntervalHours Int?
  maintenanceIntervalKm    Int?
  inspectionIntervalDays   Int?
  orderIndex               Int                     @default(0)
  isActive                 Boolean                 @default(true)
  createdAt                DateTime                @default(now())
  updatedAt                DateTime                @updatedAt
  createdBy                Int?
  updatedBy                Int?
  equipment                Equipment[]
  category                 EquipmentCategory       @relation(fields: [categoryId], references: [id])

  @@index([code])
  @@index([categoryId])
  @@index([isActive])
  @@index([orderIndex])
  @@map("Equipment_Type")
}

model Equipment {
  id                   Int                   @id @default(autoincrement())
  equipmentTypeId      Int
  code                 String                @unique
  nameAr               String
  nameEn               String?
  plateNumber          String?               @unique
  companyId            Int?
  purchaseDate         DateTime?
  purchasePrice        Float?
  currency             String?               @default("EGP")
  supplier             String?
  manufacturer         String?
  model                String?
  yearOfManufacture    Int?
  serialNumber         String?               @unique
  capacity             String?
  fuelType             FuelType?
  engineNumber         String?
  chassisNumber        String?
  color                String?
  status               EquipmentStatus       @default(AVAILABLE)
  condition            EquipmentCondition    @default(GOOD)
  currentLocation      String?
  currentProjectId     Int?
  currentOperatorId    Int?
  lastMaintenanceDate  DateTime?
  nextMaintenanceDate  DateTime?
  maintenanceInterval  Int?
  maintenanceBy        MaintenanceByType     @default(MILEAGE)
  oilChangeInterval    Int?
  lastOilChangeAt      Int?
  nextOilChangeAt      Int?
  totalWorkingHours    Int?                  @default(0)
  currentMileage       Int?                  @default(0)
  lastOilChangeDate    DateTime?
  lastOilChangeMileage Int?
  lastOilChangeHours   Int?
  nextOilChangeDue     Int?
  oilType              String?
  oilCapacity          Float?
  insuranceCompany     String?
  insuranceNumber      String?
  insuranceStartDate   DateTime?
  insuranceEndDate     DateTime?
  licenseNumber        String?
  licenseExpiryDate    DateTime?
  dailyRentalRate      Float?
  hourlyRate           Float?
  fuelConsumptionRate  Float?
  photos               Json?
  documents            Json?
  specifications       Json?
  notes                String?
  isActive             Boolean               @default(true)
  createdAt            DateTime              @default(now())
  updatedAt            DateTime              @updatedAt
  createdBy            Int?
  updatedBy            Int?
  currentOperator      Employee?             @relation("EquipmentOperator", fields: [currentOperatorId], references: [id])
  currentProject       Project?              @relation("ProjectEquipment", fields: [currentProjectId], references: [id])
  company              Company?              @relation(fields: [companyId], references: [id])
  equipmentType        EquipmentType         @relation(fields: [equipmentTypeId], references: [id])
  costs                EquipmentCost[]
  fuelLogs             FuelLog[]
  maintenanceRecords   MaintenanceRecord[]
  maintenanceSchedules MaintenanceSchedule[]
  shiftAssignments     ShiftAssignment[]
  usageRecords         EquipmentUsage[]
  
  // ğŸ”— Ù†Ø¸Ø§Ù… Ø§Ù„Ù…Ø®Ø§Ø²Ù† Ø§Ù„Ù…ÙˆØ­Ø¯ - Unified Inventory System
  inventoryTransactions  INV_Transaction[]     @relation("SparePartTransactionEquipment")
  returnedTransactions   INV_Transaction[]     @relation("ReturnedByEquipment")
  sparePartUsages        INV_SparePartUsage[]  @relation("SparePartUsageEquipment")

  @@index([code])
  @@index([plateNumber])
  @@index([equipmentTypeId])
  @@index([companyId])
  @@index([currentProjectId])
  @@index([currentOperatorId])
  @@index([status])
  @@index([condition])
  @@index([isActive])
  @@index([nextMaintenanceDate])
  @@index([insuranceEndDate])
  @@index([licenseExpiryDate])
  @@index([status, isActive])
  @@index([companyId, status])
  @@map("Equipment")
}

model MaintenanceRecord {
  id                 Int                 @id @default(autoincrement())
  equipmentId        Int
  maintenanceType    MaintenanceType
  maintenanceDate    DateTime
  nextDueDate        DateTime?
  description        String
  workPerformed      String?
  partsReplaced      String?
  laborCost          Float?              @default(0)
  partsCost          Float?              @default(0)
  totalCost          Float
  currency           String              @default("EGP")
  performedBy        String?
  performedById      Int?
  serviceProvider    String?
  invoiceNumber      String?
  mileageBefore      Int?
  mileageAfter       Int?
  workingHoursBefore Int?
  workingHoursAfter  Int?
  conditionBefore    EquipmentCondition?
  conditionAfter     EquipmentCondition?
  photos             Json?
  documents          Json?
  notes              String?
  isWarranty         Boolean             @default(false)
  createdAt          DateTime            @default(now())
  updatedAt          DateTime            @updatedAt
  createdBy          Int?
  updatedBy          Int?
  performer          Employee?           @relation("MaintenancePerformer", fields: [performedById], references: [id])
  equipment          Equipment           @relation(fields: [equipmentId], references: [id], onDelete: Cascade)

  @@index([equipmentId])
  @@index([maintenanceType])
  @@index([maintenanceDate])
  @@index([nextDueDate])
  @@index([performedById])
  @@index([equipmentId, maintenanceDate])
  @@map("Equipment_Maintenance")
}

model EquipmentUsage {
  id           Int        @id @default(autoincrement())
  equipmentId  Int
  projectId    Int?
  operatorId   Int?
  shift        WorkShift?
  startDate    DateTime
  endDate      DateTime?
  startMileage Int?
  endMileage   Int?
  workingHours Float?
  fuelConsumed Float?
  fuelCost     Float?
  location     String?
  purpose      String?
  notes        String?
  createdAt    DateTime   @default(now())
  updatedAt    DateTime   @updatedAt
  createdBy    Int?
  updatedBy    Int?
  operator     Employee?  @relation("UsageOperator", fields: [operatorId], references: [id])
  project      Project?   @relation(fields: [projectId], references: [id])
  equipment    Equipment  @relation(fields: [equipmentId], references: [id], onDelete: Cascade)

  @@index([equipmentId])
  @@index([projectId])
  @@index([operatorId])
  @@index([startDate])
  @@index([endDate])
  @@index([equipmentId, startDate])
  @@map("Equipment_Usage")
}

model EquipmentCost {
  id                  Int            @id @default(autoincrement())
  equipmentId         Int
  costType            CostType
  amount              Float
  currency            String         @default("EGP")
  costDate            DateTime
  description         String?
  supplier            String?
  invoiceNumber       String?
  paymentMethod       PaymentMethod?
  maintenanceRecordId Int?
  notes               String?
  documents           Json?
  createdAt           DateTime       @default(now())
  updatedAt           DateTime       @updatedAt
  createdBy           Int?
  updatedBy           Int?
  equipment           Equipment      @relation(fields: [equipmentId], references: [id], onDelete: Cascade)

  @@index([equipmentId])
  @@index([costType])
  @@index([costDate])
  @@index([equipmentId, costDate])
  @@map("Equipment_Cost")
}

model FuelLog {
  id             Int       @id @default(autoincrement())
  equipmentId    Int
  fuelDate       DateTime
  fuelType       FuelType
  quantity       Float
  pricePerUnit   Float
  totalCost      Float
  currency       String    @default("EGP")
  currentMileage Int?
  currentHours   Int?
  operatorId     Int?
  station        String?
  location       String?
  invoiceNumber  String?
  isFull         Boolean   @default(false)
  notes          String?
  createdAt      DateTime  @default(now())
  updatedAt      DateTime  @updatedAt
  createdBy      Int?
  updatedBy      Int?
  operator       Employee? @relation("FuelOperator", fields: [operatorId], references: [id])
  equipment      Equipment @relation(fields: [equipmentId], references: [id], onDelete: Cascade)

  @@index([equipmentId])
  @@index([fuelDate])
  @@index([operatorId])
  @@index([equipmentId, fuelDate])
  @@map("Equipment_Fuel_Log")
}

model MaintenanceSchedule {
  id                   Int                     @id @default(autoincrement())
  equipmentId          Int
  maintenanceType      MaintenanceType
  title                String
  description          String?
  isRecurring          Boolean                 @default(true)
  intervalType         MaintenanceTrackingType
  intervalValue        Int
  lastPerformedDate    DateTime?
  lastPerformedMileage Int?
  lastPerformedHours   Int?
  nextDueDate          DateTime?
  nextDueMileage       Int?
  nextDueHours         Int?
  estimatedCost        Float?
  estimatedDuration    Float?
  requiredParts        Json?
  requiredOils         Json?
  notifyBeforeDays     Int?                    @default(7)
  notifyBeforeKm       Int?
  notifyBeforeHours    Int?
  priority             MaintenancePriority     @default(NORMAL)
  status               ScheduleStatus          @default(ACTIVE)
  notes                String?
  isActive             Boolean                 @default(true)
  createdAt            DateTime                @default(now())
  updatedAt            DateTime                @updatedAt
  createdBy            Int?
  updatedBy            Int?
  equipment            Equipment               @relation(fields: [equipmentId], references: [id], onDelete: Cascade)

  @@index([equipmentId])
  @@index([maintenanceType])
  @@index([nextDueDate])
  @@index([status])
  @@index([isActive])
  @@index([equipmentId, status])
  @@map("Equipment_Maintenance_Schedule")
}

model ShiftAssignment {
  id          Int       @id @default(autoincrement())
  equipmentId Int
  operatorId  Int
  shift       WorkShift
  startDate   DateTime
  endDate     DateTime?
  workDays    Json?
  projectId   Int?
  isActive    Boolean   @default(true)
  notes       String?
  createdAt   DateTime  @default(now())
  updatedAt   DateTime  @updatedAt
  createdBy   Int?
  updatedBy   Int?
  project     Project?  @relation(fields: [projectId], references: [id])
  operator    Employee  @relation("ShiftOperator", fields: [operatorId], references: [id], onDelete: Cascade)
  equipment   Equipment @relation(fields: [equipmentId], references: [id], onDelete: Cascade)

  @@index([equipmentId])
  @@index([operatorId])
  @@index([shift])
  @@index([startDate])
  @@index([endDate])
  @@index([isActive])
  @@index([equipmentId, shift, isActive])
  @@map("Equipment_Shift_Assignment")
}

model AuditLog {
  id              Int             @id @default(autoincrement())
  timestamp       DateTime        @default(now())
  model           String
  recordId        String
  action          AuditActionType
  category        String?
  fieldName       String?
  oldValue        String?
  newValue        String?
  changedByUserId Int?
  description     String?
  metadata        Json?

  changedByUser User? @relation("UserAuditLogs", fields: [changedByUserId], references: [id])

  @@index([timestamp])
  @@index([model, recordId])
  @@index([action])
  @@index([category])
  @@index([changedByUserId])
}

enum AuditActionType {
  CREATE
  UPDATE
  DELETE
}

enum Role {
  SUPER_ADMIN
  ADMIN
  USER
  GUEST
  MODERATOR
}

enum RequestStatus {
  PENDING
  APPROVED
  REJECTED
}

enum GeneralStatus {
  PENDING
  APPROVED
  REJECTED
  SENT
  FAILED
  READ
  CANCELLED
  PLANNED
}

enum ApprovalStatus {
  PENDING
  APPROVED
  REJECTED
}

enum PaymentStatus {
  PENDING
  PAID
  CANCELLED
  FAILED
}

enum NotificationType {
  INFO
  SUCCESS
  WARNING
  ERROR
  ANNOUNCEMENT
  REMINDER
  ALERT
}

enum NotificationPriority {
  LOW
  NORMAL
  IMPORTANT
  HIGH
  URGENT
  CRITICAL
}

enum SettingScope {
  GLOBAL
  USER
  FEATURE
}

enum SettingCategory {
  SYSTEM
  SECURITY
  PERFORMANCE
  NOTIFICATION
  DATABASE
  LOGGING
  COMPANY
  BOT
}

enum SettingType {
  STRING
  NUMBER
  BOOLEAN
  JSON
  ARRAY
}

enum Gender {
  MALE
  FEMALE
}

enum MaritalStatus {
  SINGLE
  MARRIED
  DIVORCED
  WIDOWED
}

enum EmploymentType {
  FULL_TIME
  PART_TIME
  CONTRACT
  TEMPORARY
  INTERN
  FREELANCE
}

enum ContractType {
  PERMANENT
  FIXED_TERM
  PROBATION
  SEASONAL
}

enum EmploymentStatus {
  ACTIVE
  ON_LEAVE
  SUSPENDED
  RESIGNED
  TERMINATED
  RETIRED
  ON_MISSION
  SETTLED
}

enum PaymentMethod {
  CASH
  BANK_TRANSFER
  CHEQUE
  MOBILE_WALLET
}

enum TransferType {
  INSTAPAY
  CASH
}

enum SalaryCalculationType {
  MONTHLY // Ø±Ø§ØªØ¨ Ø´Ù‡Ø±ÙŠ Ø«Ø§Ø¨Øª (Ø§ÙØªØ±Ø§Ø¶ÙŠ)
  DAILY // Ø­Ø³Ø§Ø¨ Ø­Ø³Ø¨ Ø£ÙŠØ§Ù… Ø§Ù„Ø¹Ù…Ù„
}

enum EducationLevel {
  HIGH_SCHOOL
  DIPLOMA
  BACHELOR
  MASTER
  PHD
  VOCATIONAL
  OTHER
}

enum EquipmentStatus {
  AVAILABLE
  IN_USE
  MAINTENANCE
  REPAIR
  OUT_OF_SERVICE
  RENTED_OUT
  RETIRED
}

enum EquipmentCondition {
  EXCELLENT
  GOOD
  FAIR
  POOR
  DAMAGED
}

enum FuelType {
  DIESEL
  GASOLINE
  ELECTRIC
  HYBRID
  GAS
}

enum MaintenanceType {
  PREVENTIVE
  CORRECTIVE
  EMERGENCY
  INSPECTION
  OVERHAUL
  OIL_CHANGE
  TIRE_CHANGE
  REPAIR
}

enum CostType {
  FUEL
  MAINTENANCE
  REPAIR
  INSURANCE
  LICENSE
  PARTS
  LABOR
  RENTAL
  DEPRECIATION
  OTHER
}

enum MaintenanceTrackingType {
  DAYS
  HOURS
  KILOMETERS
  BOTH
}

enum WorkShift {
  MORNING
  EVENING
  NIGHT
  FULL_DAY
}

enum MaintenancePriority {
  LOW
  NORMAL
  HIGH
  URGENT
  CRITICAL
}

enum ScheduleStatus {
  ACTIVE
  COMPLETED
  OVERDUE
  CANCELLED
  PAUSED
}

enum MaintenanceScheduleType {
  DAILY
  WEEKLY
  MONTHLY
  QUARTERLY
  SEMI_ANNUAL
  ANNUAL
  BY_MILEAGE
  BY_HOURS
  BY_BOTH
}

enum MaintenanceByType {
  MILEAGE
  HOURS
}

enum ShiftType {
  MORNING
  EVENING
  NIGHT
  FLEXIBLE
}

enum ShiftStatus {
  SCHEDULED
  IN_PROGRESS
  COMPLETED
  CANCELLED
  NO_SHOW
}

enum LeaveType {
  REGULAR
  SICK
  EMERGENCY
  UNPAID
}

// Ù†ÙˆØ¹ ØªØ³ÙˆÙŠØ© Ø§Ù„Ø¥Ø¬Ø§Ø²Ø© (ÙƒÙŠÙ Ø­ØµÙ„ Ø§Ù„Ø¹Ø§Ù…Ù„ Ø¹Ù„Ù‰ Ø¥Ø¬Ø§Ø²ØªÙ‡ØŸ)
enum LeaveSettlementType {
  ACTUAL_LEAVE    // Ø¥Ø¬Ø§Ø²Ø© ÙØ¹Ù„ÙŠØ© (Ø§Ù„Ø¹Ø§Ù…Ù„ ØªØºÙŠØ¨)
  CASH_SETTLEMENT // ØªØ³ÙˆÙŠØ© Ù†Ù‚Ø¯ÙŠØ© (Ø¨Ø¯Ù„ Ù†Ù‚Ø¯ÙŠ - Ù„Ù… ÙŠØªØºÙŠØ¨)
  POSTPONED       // Ù…Ø¤Ø¬Ù„Ø©
}

// Ø£Ù†ÙˆØ§Ø¹ Ø¹Ù‚ÙˆØ¨Ø§Øª Ø§Ù„ØªØ£Ø®ÙŠØ±
enum DelayPenaltyType {
  DEDUCTION // Ø®ØµÙ… Ù…Ù† Ø§Ù„Ø±Ø§ØªØ¨
  SUSPENSION // Ø¥ÙŠÙ‚Ø§Ù Ø¹Ù† Ø§Ù„Ø¹Ù…Ù„
}

// Ø­Ø§Ù„Ø§Øª Ø§Ù„Ø¹Ù‚ÙˆØ¨Ø©
enum PenaltyStatus {
  PENDING // Ù‚ÙŠØ¯ Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©
  APPROVED // Ù…Ø¹ØªÙ…Ø¯Ø©
  CANCELLED // Ù…Ù„ØºØ§Ø© (Ù…Ø¹ Ø¹Ø°Ø±)
  APPLIED // Ù…Ø·Ø¨Ù‚Ø© Ø¹Ù„Ù‰ Ø§Ù„Ø±Ø§ØªØ¨
}

enum MissionType {
  TASK_EXECUTION
  EXTERNAL_WORK
}

model HR_EmployeeMission {
  id               Int           @id @default(autoincrement())
  missionNumber    String        @unique
  employeeId       Int
  missionType      MissionType   @default(TASK_EXECUTION)
  startDate        DateTime
  endDate          DateTime
  totalDays        Int
  location         String
  purpose          String
  allowanceAmount  Float?        @default(0)
  status           GeneralStatus @default(PENDING)
  isActive         Boolean       @default(true)
  actualReturnDate DateTime?
  notes            String?
  approvedBy       Int?
  approvedAt       DateTime?
  createdAt        DateTime      @default(now())
  updatedAt        DateTime      @updatedAt
  employee         Employee      @relation("EmployeeMissions", fields: [employeeId], references: [id], onDelete: Cascade)

  @@index([employeeId])
  @@index([missionNumber])
  @@index([missionType])
  @@index([status])
  @@index([isActive])
  @@index([startDate, endDate])
  @@index([employeeId, isActive])
}

model HR_LeaveAllowance {
  id         Int      @id @default(autoincrement())
  employeeId Int
  amount     Float
  reason     String
  isSettled  Boolean  @default(false)
  createdAt  DateTime @default(now())
  updatedAt  DateTime @updatedAt
  employee   Employee @relation("EmployeeAllowances", fields: [employeeId], references: [id], onDelete: Cascade)

  @@index([employeeId])
  @@index([isSettled])
  @@index([createdAt])
}

// ============================================
// Ù†Ø¸Ø§Ù… Ø§Ù„Ø³Ù„Ù ÙˆØ§Ù„Ù…Ø³Ø­ÙˆØ¨Ø§Øª
// ============================================

model HR_AdvanceItem {
  id           Int              @id @default(autoincrement())
  nameAr       String
  nameEn       String?
  code         String           @unique
  description  String?
  price        Float
  unit         String           @default("ÙˆØ­Ø¯Ø©")
  category     String?
  orderIndex   Int              @default(0)
  isActive     Boolean          @default(true)
  createdAt    DateTime         @default(now())
  updatedAt    DateTime         @updatedAt
  createdBy    BigInt?
  updatedBy    BigInt?
  transactions HR_Transaction[] @relation("ItemTransactions")

  // Ù†Ø¸Ø§Ù… Ø§Ù„Ø±ÙˆØ§ØªØ¨ Ø§Ù„Ø¬Ø¯ÙŠØ¯
  entitlements HR_MaterialEntitlement[] @relation("ItemEntitlements")

  @@index([code])
  @@index([isActive])
  @@index([category])
  @@index([orderIndex])
  @@index([nameAr])
  @@map("HR_AdvanceItem")
}

model HR_Transaction {
  id                Int             @id @default(autoincrement())
  transactionNumber String          @unique
  employeeId        Int
  transactionType   TransactionType @default(CASH_ADVANCE)
  itemId            Int?
  quantity          Float?
  unitPrice         Float?
  amount            Float
  description       String?
  notes             String?

  // Ù†Ø¸Ø§Ù… Ø§Ù„ØªØ³ÙˆÙŠØ© Ø§Ù„Ù…Ø²Ø¯ÙˆØ¬ (ØªØ³ÙˆÙŠØ© Ø§Ù„Ø±Ø§ØªØ¨ + ØªØ³ÙˆÙŠØ© ÙŠØ¯ÙˆÙŠØ©)
  isSettled Boolean   @default(false) // ØªÙ… Ø§Ù„Ø®ØµÙ… Ù…Ù† Ø±Ø§ØªØ¨ØŸ
  settledAt DateTime? // ØªØ§Ø±ÙŠØ® Ø§Ù„Ø®ØµÙ… Ù…Ù† Ø§Ù„Ø±Ø§ØªØ¨
  settledBy BigInt? // Ù…Ù† Ù‚Ø§Ù… Ø¨Ø§Ù„Ø®ØµÙ… Ù…Ù† Ø§Ù„Ø±Ø§ØªØ¨

  isManuallySettled    Boolean   @default(false) // ØªÙ… Ø§Ù„ØªØ¹Ø§Ù…Ù„ Ù…Ø¹Ù‡Ø§ Ø®Ø§Ø±Ø¬ Ø§Ù„Ù†Ø¸Ø§Ù…ØŸ
  manualSettlementType String? // Ù†ÙˆØ¹ Ø§Ù„ØªØ³ÙˆÙŠØ©: EXTERNAL_PAYMENT, CANCELED, OTHER
  manualSettlementNote String? // Ù…Ù„Ø§Ø­Ø¸Ø© Ø§Ù„ØªØ³ÙˆÙŠØ© Ø§Ù„ÙŠØ¯ÙˆÙŠØ©
  manuallySettledAt    DateTime? // ØªØ§Ø±ÙŠØ® Ø§Ù„ØªØ³ÙˆÙŠØ© Ø§Ù„ÙŠØ¯ÙˆÙŠØ©
  manuallySettledBy    BigInt? // Ù…Ù† Ù‚Ø§Ù… Ø¨Ø§Ù„ØªØ³ÙˆÙŠØ© Ø§Ù„ÙŠØ¯ÙˆÙŠØ©

  status          GeneralStatus              @default(PENDING)
  approvedBy      BigInt?
  approvedAt      DateTime?
  rejectionReason String?
  createdAt       DateTime                   @default(now())
  updatedAt       DateTime                   @updatedAt
  createdBy       BigInt?
  updatedBy       BigInt?
  employee        Employee                   @relation("EmployeeTransactions", fields: [employeeId], references: [id], onDelete: Cascade)
  item            HR_AdvanceItem?            @relation("ItemTransactions", fields: [itemId], references: [id])
  settlements     HR_TransactionSettlement[] @relation("TransactionSettlements")
  changeLogs      HR_TransactionChangeLog[]  @relation("TransactionChangeLogs")

  @@index([employeeId])
  @@index([transactionNumber])
  @@index([transactionType])
  @@index([isSettled])
  @@index([isManuallySettled])
  @@index([status])
  @@index([createdAt])
  @@index([itemId])
  @@index([employeeId, isSettled])
  @@index([employeeId, isManuallySettled])
  @@index([employeeId, createdAt])
  @@map("HR_Transaction")
}

model HR_TransactionSettlement {
  id             Int             @id @default(autoincrement())
  transactionIds Json
  settlementType SettlementType  @default(INDIVIDUAL)
  totalAmount    Float
  description    String?
  settledBy      BigInt
  settledAt      DateTime        @default(now())
  createdAt      DateTime        @default(now())
  updatedAt      DateTime        @updatedAt
  transaction    HR_Transaction? @relation("TransactionSettlements", fields: [transactionId], references: [id])
  transactionId  Int?

  @@index([settledBy])
  @@index([settlementType])
  @@index([settledAt])
  @@index([createdAt])
  @@map("HR_TransactionSettlement")
}

model HR_TransactionChangeLog {
  id            Int                   @id @default(autoincrement())
  transactionId Int
  changeType    TransactionChangeType @default(EDIT)
  fieldName     String?
  oldValue      String?
  newValue      String?
  reason        String
  changedBy     BigInt
  changedAt     DateTime              @default(now())
  metadata      Json?
  transaction   HR_Transaction        @relation("TransactionChangeLogs", fields: [transactionId], references: [id], onDelete: Cascade)

  @@index([transactionId])
  @@index([changeType])
  @@index([changedBy])
  @@index([changedAt])
  @@index([transactionId, changedAt])
  @@map("HR_TransactionChangeLog")
}

enum TransactionType {
  CASH_ADVANCE
  ITEM_WITHDRAWAL
  EMPLOYEE_DEBT
}

enum SettlementType {
  INDIVIDUAL
  BULK
  CUSTOM
}

enum TransactionChangeType {
  EDIT
  DELETE
  RESTORE
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// Ù†Ø¸Ø§Ù… Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø£Ù‚Ø³Ø§Ù… ÙˆØ§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª
// Department Management & Permissions System
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

model DepartmentConfig {
  id          Int                @id @default(autoincrement())
  code        String             @unique // 'hr-management', 'notifications', etc.
  name        String // Ø§Ø³Ù… Ø§Ù„Ù‚Ø³Ù…
  nameEn      String? // English name
  description String? // ÙˆØµÙ Ø§Ù„Ù‚Ø³Ù…
  isEnabled   Boolean            @default(true) // ØªØ´ØºÙŠÙ„/Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„Ù‚Ø³Ù…
  minRole     String             @default("ADMIN") // Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ø¯Ù†Ù‰ Ù„Ù„ÙˆØµÙˆÙ„: SUPER_ADMIN, ADMIN, USER, GUEST
  icon        String? // Ø£ÙŠÙ‚ÙˆÙ†Ø© Ø§Ù„Ù‚Ø³Ù…
  order       Int                @default(0) // ØªØ±ØªÙŠØ¨ Ø§Ù„Ø¹Ø±Ø¶
  createdAt   DateTime           @default(now())
  updatedAt   DateTime           @updatedAt
  createdBy   BigInt? // Ù…Ù† Ø£Ù†Ø´Ø£ Ø§Ù„Ù‚Ø³Ù…
  updatedBy   BigInt? // Ø¢Ø®Ø± Ù…Ù† Ø¹Ø¯Ù‘Ù„ Ø§Ù„Ù‚Ø³Ù…
  admins      DepartmentAdmin[]  @relation("DepartmentAdmins")
  subFeatures SubFeatureConfig[] @relation("DepartmentSubFeatures")

  @@index([code])
  @@index([isEnabled])
  @@index([minRole])
  @@map("DepartmentConfig")
}

model DepartmentAdmin {
  id           Int              @id @default(autoincrement())
  departmentId Int // Ù…Ø¹Ø±Ù Ø§Ù„Ù‚Ø³Ù…
  userId       Int // Ù…Ø¹Ø±Ù Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
  telegramId   BigInt // Ù…Ø¹Ø±Ù ØªÙŠÙ„ÙŠØ¬Ø±Ø§Ù… Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù…
  assignedAt   DateTime         @default(now())
  assignedBy   BigInt // Ù…Ù† Ù‚Ø§Ù… Ø¨Ø§Ù„ØªØ¹ÙŠÙŠÙ†
  isActive     Boolean          @default(true)
  notes        String? // Ù…Ù„Ø§Ø­Ø¸Ø§Øª
  createdAt    DateTime         @default(now())
  updatedAt    DateTime         @updatedAt
  department   DepartmentConfig @relation("DepartmentAdmins", fields: [departmentId], references: [id], onDelete: Cascade)
  user         User             @relation("UserDepartments", fields: [userId], references: [id], onDelete: Cascade)

  @@unique([departmentId, userId])
  @@index([departmentId])
  @@index([userId])
  @@index([telegramId])
  @@index([isActive])
  @@map("DepartmentAdmin")
}

// ØªØ¹Ø±ÙŠÙ Ø§Ù„ÙˆØ¸Ø§Ø¦Ù Ø§Ù„ÙØ±Ø¹ÙŠØ© Ø¯Ø§Ø®Ù„ ÙƒÙ„ Ù‚Ø³Ù…
model SubFeatureConfig {
  id             Int               @id @default(autoincrement())
  code           String            @unique // 'hr:advances', 'hr:employees', etc.
  departmentCode String // 'hr-management'
  name           String // Ø§Ø³Ù… Ø§Ù„ÙˆØ¸ÙŠÙØ©
  nameEn         String? // English name
  description    String? // ÙˆØµÙ Ø§Ù„ÙˆØ¸ÙŠÙØ©
  isEnabled      Boolean           @default(true) // ØªØ´ØºÙŠÙ„/Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„ÙˆØ¸ÙŠÙØ©
  minRole        String? // Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ø¯Ù†Ù‰ Ù„Ù„ÙˆØµÙˆÙ„ (NULL = ÙŠØ±Ø« Ù…Ù† Ø§Ù„Ù‚Ø³Ù…)
  icon           String? // Ø£ÙŠÙ‚ÙˆÙ†Ø© Ø§Ù„ÙˆØ¸ÙŠÙØ©
  order          Int               @default(0) // ØªØ±ØªÙŠØ¨ Ø§Ù„Ø¹Ø±Ø¶
  superAdminOnly Boolean           @default(false) // (Ù…Ù‡Ù…Ù„) Ø§Ø³ØªØ®Ø¯Ù… minRole Ø¨Ø¯Ù„Ø§Ù‹ Ù…Ù†Ù‡
  createdAt      DateTime          @default(now())
  updatedAt      DateTime          @updatedAt
  createdBy      BigInt? // Ù…Ù† Ø£Ù†Ø´Ø£ Ø§Ù„ÙˆØ¸ÙŠÙØ©
  updatedBy      BigInt? // Ø¢Ø®Ø± Ù…Ù† Ø¹Ø¯Ù‘Ù„ Ø§Ù„ÙˆØ¸ÙŠÙØ©
  admins         SubFeatureAdmin[] @relation("SubFeatureAdmins")
  department     DepartmentConfig? @relation("DepartmentSubFeatures", fields: [departmentCode], references: [code])

  @@index([code])
  @@index([departmentCode])
  @@index([isEnabled])
  @@index([minRole])
  @@index([superAdminOnly])
  @@map("SubFeatureConfig")
}

// Ø§Ù„Ø£Ø¯Ù…Ù† Ø§Ù„Ù…Ø¹ÙŠÙ†ÙŠÙ† Ø¹Ù„Ù‰ ÙˆØ¸ÙŠÙØ© ÙØ±Ø¹ÙŠØ© Ù…Ø­Ø¯Ø¯Ø©
model SubFeatureAdmin {
  id           Int              @id @default(autoincrement())
  subFeatureId Int // Ù…Ø¹Ø±Ù Ø§Ù„ÙˆØ¸ÙŠÙØ© Ø§Ù„ÙØ±Ø¹ÙŠØ©
  userId       Int // Ù…Ø¹Ø±Ù Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
  telegramId   BigInt // Ù…Ø¹Ø±Ù ØªÙŠÙ„ÙŠØ¬Ø±Ø§Ù… Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù…
  assignedAt   DateTime         @default(now())
  assignedBy   BigInt // Ù…Ù† Ù‚Ø§Ù… Ø¨Ø§Ù„ØªØ¹ÙŠÙŠÙ†
  isActive     Boolean          @default(true)
  notes        String? // Ù…Ù„Ø§Ø­Ø¸Ø§Øª
  createdAt    DateTime         @default(now())
  updatedAt    DateTime         @updatedAt
  subFeature   SubFeatureConfig @relation("SubFeatureAdmins", fields: [subFeatureId], references: [id], onDelete: Cascade)
  user         User             @relation("UserSubFeatures", fields: [userId], references: [id], onDelete: Cascade)

  @@unique([subFeatureId, userId])
  @@index([subFeatureId])
  @@index([userId])
  @@index([telegramId])
  @@index([isActive])
  @@map("SubFeatureAdmin")
}

// ========================================
// Ù†Ø¸Ø§Ù… Ø¹Ù‚ÙˆØ¨Ø§Øª Ø§Ù„ØªØ£Ø®ÙŠØ± ÙÙŠ Ø§Ù„Ø¥Ø¬Ø§Ø²Ø§Øª
// ========================================

// Ø³ÙŠØ§Ø³Ø§Øª Ø¹Ù‚ÙˆØ¨Ø§Øª Ø§Ù„ØªØ£Ø®ÙŠØ±
model HR_DelayPenaltyPolicy {
  id          Int     @id @default(autoincrement())
  name        String // Ø§Ø³Ù… Ø§Ù„Ø³ÙŠØ§Ø³Ø©
  description String? // ÙˆØµÙ Ø§Ù„Ø³ÙŠØ§Ø³Ø©

  // Ù†Ø·Ø§Ù‚ Ø£ÙŠØ§Ù… Ø§Ù„ØªØ£Ø®ÙŠØ±
  delayDays Int @unique // Ø¹Ø¯Ø¯ Ø£ÙŠØ§Ù… Ø§Ù„ØªØ£Ø®ÙŠØ± (1, 2, 3, 4, 5+)

  // Ù†ÙˆØ¹ Ø§Ù„Ø¹Ù‚ÙˆØ¨Ø©
  penaltyType DelayPenaltyType // DEDUCTION Ø£Ùˆ SUSPENSION

  // Ù‚ÙŠÙ…Ø© Ø§Ù„Ø¹Ù‚ÙˆØ¨Ø©
  deductionDays  Float? // Ø¹Ø¯Ø¯ Ø£ÙŠØ§Ù… Ø§Ù„Ø®ØµÙ… Ù…Ù† Ø§Ù„Ø±Ø§ØªØ¨
  suspensionDays Int? // Ø¹Ø¯Ø¯ Ø£ÙŠØ§Ù… Ø§Ù„Ø¥ÙŠÙ‚Ø§Ù (null = ØºÙŠØ± Ù…Ø­Ø¯Ø¯)

  isActive  Boolean  @default(true)
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  createdBy BigInt? // Ù…Ù† Ø£Ù†Ø´Ø£ Ø§Ù„Ø³ÙŠØ§Ø³Ø©
  updatedBy BigInt? // Ø¢Ø®Ø± Ù…Ù† Ø¹Ø¯Ù‘Ù„Ù‡Ø§

  // Ø§Ù„Ø¹Ù‚ÙˆØ¨Ø§Øª Ø§Ù„Ù…Ø·Ø¨Ù‚Ø© Ø¨Ù‡Ø°Ù‡ Ø§Ù„Ø³ÙŠØ§Ø³Ø©
  appliedPenalties HR_AppliedPenalty[]

  @@index([delayDays])
  @@index([isActive])
  @@map("HR_DelayPenaltyPolicy")
}

// Ø§Ù„Ø¹Ù‚ÙˆØ¨Ø§Øª Ø§Ù„Ù…Ø·Ø¨Ù‚Ø© Ø¹Ù„Ù‰ Ø§Ù„Ø¹Ø§Ù…Ù„ÙŠÙ†
model HR_AppliedPenalty {
  id Int @id @default(autoincrement())

  // Ø±Ø¨Ø· Ø¨Ø§Ù„Ø¥Ø¬Ø§Ø²Ø© ÙˆØ§Ù„Ø¹Ø§Ù…Ù„
  leaveId    Int
  leave      HR_EmployeeLeave @relation("LeaveAppliedPenalties", fields: [leaveId], references: [id])
  employeeId Int
  employee   Employee         @relation("EmployeeAppliedPenalties", fields: [employeeId], references: [id])

  // ØªÙØ§ØµÙŠÙ„ Ø§Ù„ØªØ£Ø®ÙŠØ±
  delayDays Int // Ø¹Ø¯Ø¯ Ø£ÙŠØ§Ù… Ø§Ù„ØªØ£Ø®ÙŠØ± Ø§Ù„ÙØ¹Ù„ÙŠ

  // Ø§Ù„Ø³ÙŠØ§Ø³Ø© Ø§Ù„Ù…Ø·Ø¨Ù‚Ø©
  policyId Int?
  policy   HR_DelayPenaltyPolicy? @relation(fields: [policyId], references: [id])

  // Ù†ÙˆØ¹ ÙˆÙ‚ÙŠÙ…Ø© Ø§Ù„Ø¹Ù‚ÙˆØ¨Ø© Ø§Ù„Ù…Ø·Ø¨Ù‚Ø©
  penaltyType    DelayPenaltyType
  deductionDays  Float? // Ø£ÙŠØ§Ù… Ø§Ù„Ø®ØµÙ… Ø§Ù„ÙØ¹Ù„ÙŠØ©
  suspensionDays Int? // Ø£ÙŠØ§Ù… Ø§Ù„Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„ÙØ¹Ù„ÙŠØ©

  // Ø­Ø§Ù„Ø© Ø§Ù„Ø¹Ù‚ÙˆØ¨Ø©
  status PenaltyStatus @default(PENDING)

  // Ø§Ù„Ø¥Ù„ØºØ§Ø¡ ÙˆØ§Ù„Ø¹Ø°Ø±
  isCancelled  Boolean   @default(false)
  cancelReason String? // Ø³Ø¨Ø¨ Ø§Ù„Ø¥Ù„ØºØ§Ø¡/Ø§Ù„Ø¹Ø°Ø±
  cancelledBy  BigInt? // Ù…Ù† Ø£Ù„ØºÙ‰ Ø§Ù„Ø¹Ù‚ÙˆØ¨Ø©
  cancelledAt  DateTime?

  // Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø¹Ù„Ù‰ Ø§Ù„Ø±Ø§ØªØ¨
  isAppliedToPayroll Boolean           @default(false)
  payrollRecordId    Int?
  payrollRecord      HR_PayrollRecord? @relation("PayrollAppliedPenalties", fields: [payrollRecordId], references: [id])
  appliedToPayrollAt DateTime?

  // Ø§Ù„ØªØ³Ø¬ÙŠÙ„
  createdBy BigInt
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  notes String? // Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ©

  @@index([leaveId])
  @@index([employeeId])
  @@index([status])
  @@index([isCancelled])
  @@index([isAppliedToPayroll])
  @@map("HR_AppliedPenalty")
}

// Ø³Ø¬Ù„ ØªØ¹Ø¯ÙŠÙ„Ø§Øª Ø¯ÙˆØ±Ø§Øª Ø§Ù„Ø¹Ù…Ù„ ÙˆØ§Ù„Ø¥Ø¬Ø§Ø²Ø§Øª
model HR_CycleChangeLog {
  id Int @id @default(autoincrement())

  // Ù†ÙˆØ¹ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„
  entityType String // "Position" Ø£Ùˆ "Employee"
  entityId   Int // ID Ø§Ù„ÙˆØ¸ÙŠÙØ© Ø£Ùˆ Ø§Ù„Ù…ÙˆØ¸Ù

  // Ø§Ù„Ù‚ÙŠÙ… Ø§Ù„Ù‚Ø¯ÙŠÙ…Ø©
  oldWorkDays  Int?
  oldLeaveDays Int?

  // Ø§Ù„Ù‚ÙŠÙ… Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©
  newWorkDays  Int?
  newLeaveDays Int?

  // Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„ØªØ¹Ø¯ÙŠÙ„
  changedBy BigInt
  changedAt DateTime @default(now())
  reason    String? // Ø³Ø¨Ø¨ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)

  @@index([entityType, entityId])
  @@index([changedBy])
  @@index([changedAt])
  @@map("HR_CycleChangeLog")
}

// ============================================
// Ù†Ø¸Ø§Ù… Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ù‚Ø³Ù… Ø´Ø¦ÙˆÙ† Ø§Ù„Ø¹Ø§Ù…Ù„ÙŠÙ†
// ============================================

model HR_Settings {
  id        Int      @id @default(autoincrement())
  
  // Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª
  notificationsEnabled       Boolean  @default(true)   // ØªÙØ¹ÙŠÙ„/ØªØ¹Ø·ÙŠÙ„ Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª
  notificationTime           String   @default("09:00") // ÙˆÙ‚Øª Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª Ø§Ù„ÙŠÙˆÙ…ÙŠØ© (HH:MM)
  leaveStartReminderDays     Int      @default(1)      // Ø¥Ø´Ø¹Ø§Ø± Ù‚Ø¨Ù„ Ø¨Ø¯Ø§ÙŠØ© Ø§Ù„Ø¥Ø¬Ø§Ø²Ø© Ø¨ÙƒÙ… ÙŠÙˆÙ…
  leaveEndReminderDays       Int      @default(1)      // Ø¥Ø´Ø¹Ø§Ø± Ù‚Ø¨Ù„ Ù†Ù‡Ø§ÙŠØ© Ø§Ù„Ø¥Ø¬Ø§Ø²Ø© Ø¨ÙƒÙ… ÙŠÙˆÙ…
  
  // Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù‚Ø³Ù… Ø§Ù„Ø¹Ø§Ù…Ø©
  sectionEnabled             Boolean  @default(true)   // ØªÙØ¹ÙŠÙ„/ØªØ¹Ø·ÙŠÙ„ Ø§Ù„Ù‚Ø³Ù…
  
  // Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„ØªØ¹Ø¯ÙŠÙ„
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  updatedBy BigInt?
  
  @@map("HR_Settings")
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// Ù†Ø¸Ø§Ù… Ø§Ù„Ù…Ø®Ø§Ø²Ù† Ø§Ù„Ù…ÙˆØ­Ø¯ - Unified Inventory System V3
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

// 1ï¸âƒ£ ÙØ¦Ø§Øª Ø§Ù„Ù…Ø®Ø²ÙˆÙ† Ø§Ù„Ù…ÙˆØ­Ø¯Ø© (Unified Categories)
model INV_Category {
  id           Int       @id @default(autoincrement())
  code         String    @unique // "SPARE_PART", "OILS_GREASE", "FUEL", "TOOLS"
  nameAr       String // "Ù‚Ø·Ø¹ ØºÙŠØ§Ø±", "Ø²ÙŠÙˆØª ÙˆØ´Ø­ÙˆÙ…", "Ø³ÙˆÙ„Ø§Ø±", "Ø¹Ø¯Ø¯ ÙˆØ£Ø¯ÙˆØ§Øª"
  nameEn       String?
  description  String?
  icon         String? // âš™ï¸, ğŸ›¢ï¸, â›½, ğŸ› ï¸
  prefix       String?   @unique // "SP", "OG", "FL", "TL" (ÙŠØ³ØªØ®Ø¯Ù… Ù„ØªÙˆÙ„ÙŠØ¯ ÙƒÙˆØ¯ Ø§Ù„ØµÙ†Ù)
  warehouseType String   @default("oils-greases") // "spare-parts", "oils-greases", "diesel", "tools" - Ù†ÙˆØ¹ Ø§Ù„Ù…Ø®Ø²Ù†
  orderIndex   Int       @default(0)
  displayOrder Int       @default(0) // Ù„Ù„ØªÙˆØ§ÙÙ‚ Ù…Ø¹ Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„Ù‚Ø¯ÙŠÙ…
  isActive     Boolean   @default(true)
  createdAt    DateTime  @default(now())
  updatedAt    DateTime  @updatedAt
  createdBy    BigInt?
  updatedBy    BigInt?

  // Ø§Ù„Ø¹Ù„Ø§Ù‚Ø§Øª
  items INV_Item[] @relation("CategoryItems")

  @@index([code])
  @@index([isActive])
  @@index([warehouseType])
  @@index([warehouseType, isActive])
  @@map("INV_Category")
}

// 2ï¸âƒ£ Ù…ÙˆØ§Ù‚Ø¹ Ø§Ù„ØªØ®Ø²ÙŠÙ† Ø§Ù„Ù…ÙˆØ­Ø¯Ø© (Unified Storage Locations)
model INV_StorageLocation {
  id           Int       @id @default(autoincrement())
  code         String    @unique // "CONT-1", "SHELF-A1", "RACK-5"
  nameAr       String // "ÙƒØ±Ø³ØªØ± Ø±Ù‚Ù… 1 - ÙƒØ±ÙØ§Ù† Ø§Ù„Ø¹Ø§Ù…Ù„ÙŠÙ†"
  nameEn       String?
  locationType String    @default("SHELF") // "CONTAINER", "SHELF", "RACK", "ROOM", "VEHICLE"
  locationArea String? // "Ù…Ø®Ø²Ù† Ø±Ø¦ÙŠØ³ÙŠ", "ÙˆØ±Ø´Ø©", "Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø¹Ù…Ù„"
  description  String?
  notes        String?
  orderIndex   Int       @default(0)
  isActive     Boolean   @default(true)
  createdAt    DateTime  @default(now())
  updatedAt    DateTime  @updatedAt
  createdBy    BigInt?
  updatedBy    BigInt?

  // Ø§Ù„Ø¹Ù„Ø§Ù‚Ø§Øª
  items              INV_Item[]        @relation("ItemDefaultLocation")
  stockRecords       INV_Stock[]       @relation("LocationStockRecords")
  transactions       INV_Transaction[] @relation("LocationTransactions")
  fromTransactions   INV_Transaction[] @relation("FromTransactions")
  toTransactions     INV_Transaction[] @relation("ToTransactions")

  @@index([code])
  @@index([locationType])
  @@index([isActive])
  @@index([orderIndex])
  @@map("INV_StorageLocation")
}

// 3ï¸âƒ£ ÙƒØªØ§Ù„ÙˆØ¬ Ø§Ù„Ø£ØµÙ†Ø§Ù Ø§Ù„Ù…ÙˆØ­Ø¯ (Unified Items Catalog)
model INV_Item {
  id          Int    @id @default(autoincrement())
  code        String @unique // "SP-00123", "OG-0001" (Ù…ÙÙˆÙ„Ù‘Ø¯ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹)
  barcode     String? @unique // "6281234567890" (EAN-13)
  
  // Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø£Ø³Ø§Ø³ÙŠØ©
  nameAr      String // "ÙÙ„ØªØ± Ø²ÙŠØª Ù…Ø­Ø±Ùƒ", "Ø²ÙŠØª Ù‡ÙŠØ¯Ø±ÙˆÙ„ÙŠÙƒ 68"
  nameEn      String?
  description String?
  notes       String? // Ù…Ù„Ø§Ø­Ø¸Ø§Øª
  
  // Ø§Ù„ØªØµÙ†ÙŠÙ
  categoryId  Int // Ø§Ù„Ø±Ø¨Ø· Ù…Ø¹ INV_Category
  
  // Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ (Ù„Ù„ØªÙˆØ§ÙÙ‚ Ù…Ø¹ Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„Ù‚Ø¯ÙŠÙ…) â­
  locationId  Int? // Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ/Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ Ù„Ù„ØµÙ†Ù
  
  // Ø§Ù„ÙˆØ­Ø¯Ø©
  unit        String  @default("Ù‚Ø·Ø¹Ø©") // "Ù‚Ø·Ø¹Ø©", "Ù„ØªØ±", "Ø¬Ø§Ù„ÙˆÙ†", "Ø¨Ø±Ù…ÙŠÙ„"
  unitCapacity Float? // Ø³Ø¹Ø© Ø§Ù„ÙˆØ­Ø¯Ø© Ø¨Ø§Ù„Ù„ØªØ± (Ù„Ù„Ø¬Ø§Ù„ÙˆÙ† ÙˆØ§Ù„Ø¨Ø±Ù…ÙŠÙ„)
  
  // Ø§Ù„Ø³Ø¹Ø± ÙˆØ§Ù„ÙƒÙ…ÙŠØ§Øª (Ù„Ù„ØªÙˆØ§ÙÙ‚ Ù…Ø¹ Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„Ù‚Ø¯ÙŠÙ…) â­
  unitPrice   Float   @default(0) // Ø³Ø¹Ø± Ø§Ù„ÙˆØ­Ø¯Ø©
  minQuantity Float   @default(5) // Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ø¯Ù†Ù‰ Ù„Ù„ØªÙ†Ø¨ÙŠÙ‡
  quantity    Float   @default(0) // Ø§Ù„ÙƒÙ…ÙŠØ© Ø§Ù„Ø­Ø§Ù„ÙŠØ© (Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ù…Ù† stocks)
  totalValue  Float   @default(0) // Ø§Ù„Ù‚ÙŠÙ…Ø© Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠØ© (Ù…Ø­Ø³ÙˆØ¨Ø©)
  currency    String  @default("EGP") // Ø§Ù„Ø¹Ù…Ù„Ø©
  
  // Ø§Ù„Ø­Ø§Ù„Ø© ÙˆØ§Ù„ÙƒÙ…ÙŠØ§Øª Ø§Ù„ØªÙØµÙŠÙ„ÙŠØ© (Ù„Ù‚Ø·Ø¹ Ø§Ù„ØºÙŠØ§Ø±)
  status              String  @default("AVAILABLE") // "AVAILABLE", "OUT_OF_STOCK", "RESERVED", "DISCONTINUED"
  condition           String  @default("NEW") // "NEW", "USED", "REFURBISHED"
  quantityNew         Float   @default(0) // Ø§Ù„ÙƒÙ…ÙŠØ© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©
  quantityUsed        Float   @default(0) // Ø§Ù„ÙƒÙ…ÙŠØ© Ø§Ù„Ù…Ø³ØªØ¹Ù…Ù„Ø©
  quantityRefurbished Float   @default(0) // Ø§Ù„ÙƒÙ…ÙŠØ© Ø§Ù„Ù…Ø¬Ø¯Ø¯Ø©
  quantityImport      Float   @default(0) // Ø§Ù„ÙƒÙ…ÙŠØ© Ø§Ù„Ù…Ø³ØªÙˆØ±Ø¯Ø©
  
  // Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù…ÙˆÙ‘Ø±Ø¯
  supplierName    String? // Ø§Ø³Ù… Ø§Ù„Ù…ÙˆØ±Ø¯
  supplierContact String? // Ø¬ÙˆØ§Ù„/Ø¨Ø±ÙŠØ¯ Ø§Ù„Ù…ÙˆØ±Ø¯
  
  // Ù…Ø¹Ù„ÙˆÙ…Ø§Øª ØªÙ‚Ù†ÙŠØ©
  partNumber      String? // Ø±Ù‚Ù… Ø§Ù„Ù‚Ø·Ø¹Ø© Ù…Ù† Ø§Ù„Ø´Ø±ÙƒØ© Ø§Ù„Ù…ØµÙ†Ø¹Ø©
  manufacturer    String? // Ø§Ù„Ø´Ø±ÙƒØ© Ø§Ù„Ù…ØµÙ†Ø¹Ø©
  specifications  Json? // Ù…ÙˆØ§ØµÙØ§Øª ØªÙ‚Ù†ÙŠØ© (Ù„Ø²ÙˆØ¬Ø©ØŒ Ù…ÙˆØ¯ÙŠÙ„ Ù…ØªÙˆØ§ÙÙ‚ØŒ Ø¥Ù„Ø®)
  
  // Ø§Ù„ØµÙˆØ± ÙˆØ§Ù„Ù…Ù„ÙØ§Øª
  imagePath  String? // Ù…Ø³Ø§Ø± Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©
  images     Json? // ØµÙˆØ± Ø¥Ø¶Ø§ÙÙŠØ©
  documents  Json? // Ù…Ø³ØªÙ†Ø¯Ø§Øª
  
  // ğŸ”— Ø§Ù„Ø±Ø¨Ø· Ø¨Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ† (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)
  responsibleEmployeeId Int? // Ø§Ù„Ù…ÙˆØ¸Ù Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ Ø¹Ù† Ø§Ù„ØµÙ†Ù
  
  // Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„ØªØ³Ø¬ÙŠÙ„
  isActive  Boolean  @default(true)
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  createdBy BigInt?
  updatedBy BigInt?
  
  // Ø§Ù„Ø¹Ù„Ø§Ù‚Ø§Øª
  category            INV_Category            @relation("CategoryItems", fields: [categoryId], references: [id])
  location            INV_StorageLocation?    @relation("ItemDefaultLocation", fields: [locationId], references: [id])
  responsibleEmployee Employee?               @relation("SparePartResponsible", fields: [responsibleEmployeeId], references: [id])
  stocks              INV_Stock[]             @relation("ItemStockRecords")
  transactions        INV_Transaction[]       @relation("ItemTransactions")
  usageRecords        INV_SparePartUsage[]    @relation("SparePartUsages")
  damageRecords       INV_DamageRecord[]      @relation("SparePartDamages")
  auditItems          INV_InventoryAuditItem[] @relation("AuditItems")
  
  @@index([code])
  @@index([barcode])
  @@index([categoryId])
  @@index([locationId])
  @@index([isActive])
  @@index([nameAr])
  @@index([partNumber])
  @@index([manufacturer])
  @@index([responsibleEmployeeId])
  @@map("INV_Item")
}

// 4ï¸âƒ£ Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø£Ø±ØµØ¯Ø© (ÙØµÙ„ Ø§Ù„ØµÙ†Ù Ø¹Ù† Ø±ØµÙŠØ¯Ù‡) â­
model INV_Stock {
  id          Int   @id @default(autoincrement())
  itemId      Int // Ù…Ø¹Ø±Ù Ø§Ù„ØµÙ†Ù
  locationId  Int // Ù…Ø¹Ø±Ù Ù…ÙˆÙ‚Ø¹ Ø§Ù„ØªØ®Ø²ÙŠÙ†
  
  // Ø§Ù„ÙƒÙ…ÙŠØ§Øª
  quantity            Float @default(0) // Ø§Ù„ÙƒÙ…ÙŠØ© Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠØ© Ø§Ù„Ø­Ø§Ù„ÙŠØ©
  quantityNew         Float @default(0) // Ø§Ù„ÙƒÙ…ÙŠØ© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©
  quantityUsed        Float @default(0) // Ø§Ù„ÙƒÙ…ÙŠØ© Ø§Ù„Ù…Ø³ØªØ¹Ù…Ù„Ø©
  quantityRefurbished Float @default(0) // Ø§Ù„ÙƒÙ…ÙŠØ© Ø§Ù„Ù…Ø¬Ø¯Ø¯Ø©
  
  // Ø§Ù„ØªÙƒÙ„ÙØ© (ÙŠØªÙ… ØªØ­Ø¯ÙŠØ«Ù‡Ø§ Ø¢Ù„ÙŠØ§Ù‹)
  lastUnitPrice Float @default(0) // Ø¢Ø®Ø± Ø³Ø¹Ø± Ø´Ø±Ø§Ø¡
  averageCost   Float @default(0) // Ù…ØªÙˆØ³Ø· Ø§Ù„ØªÙƒÙ„ÙØ© Ø§Ù„Ù…Ø±Ø¬Ø­ (WAC) â­
  totalValue    Float @default(0) // Ø§Ù„Ù‚ÙŠÙ…Ø© Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠØ© (quantity Ã— averageCost)
  
  // Ø­Ø¯ÙˆØ¯ Ø§Ù„Ù…Ø®Ø²ÙˆÙ†
  minQuantity   Float  @default(5) // Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ø¯Ù†Ù‰ Ù„Ù„ØªÙ†Ø¨ÙŠÙ‡
  maxQuantity   Float? // Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ù‚ØµÙ‰ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)
  reorderPoint  Float? // Ù†Ù‚Ø·Ø© Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ø·Ù„Ø¨
  
  // Ø§Ù„Ø­Ø§Ù„Ø©
  status String @default("AVAILABLE") // "AVAILABLE", "OUT_OF_STOCK", "RESERVED", "DAMAGED"
  
  // Ø§Ù„ØªÙˆØ§Ø±ÙŠØ®
  lastPurchaseDate DateTime? // Ø¢Ø®Ø± ØªØ§Ø±ÙŠØ® Ø´Ø±Ø§Ø¡
  lastUsedDate     DateTime? // Ø¢Ø®Ø± ØªØ§Ø±ÙŠØ® ØµØ±Ù
  expiryDate       DateTime? // ØªØ§Ø±ÙŠØ® Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ© (Ù„Ù„Ø²ÙŠÙˆØª)
  
  // Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„ØªØ³Ø¬ÙŠÙ„
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  createdBy BigInt?
  updatedBy BigInt?
  
  // Ø§Ù„Ø¹Ù„Ø§Ù‚Ø§Øª
  item     INV_Item            @relation("ItemStockRecords", fields: [itemId], references: [id], onDelete: Cascade)
  location INV_StorageLocation @relation("LocationStockRecords", fields: [locationId], references: [id])
  
  @@unique([itemId, locationId]) // Ù„Ø§ ÙŠÙ…ÙƒÙ† ØªÙƒØ±Ø§Ø± Ù†ÙØ³ Ø§Ù„ØµÙ†Ù ÙÙŠ Ù†ÙØ³ Ø§Ù„Ù…ÙˆÙ‚Ø¹
  @@index([itemId])
  @@index([locationId])
  @@index([quantity])
  @@index([status])
  @@map("INV_Stock")
}

// 5ï¸âƒ£ Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø­Ø±ÙƒØ§Øª Ø§Ù„Ù…ÙˆØ­Ø¯ (Unified Transactions)
model INV_Transaction {
  id                Int    @id @default(autoincrement())
  transactionNumber String @unique // "TRX-20251116-001"
  itemId            Int // Ù…Ø¹Ø±Ù Ø§Ù„ØµÙ†Ù Ø§Ù„Ù…ÙˆØ­Ø¯
  
  // Ù†ÙˆØ¹ Ø§Ù„Ø­Ø±ÙƒØ© (Ù‡Ø§Ù… Ø¬Ø¯Ø§Ù‹)
  transactionType String // "PURCHASE", "ISSUANCE", "TRANSFER", "RETURN", "ADJUSTMENT"
  
  // Ø§Ù„ÙƒÙ…ÙŠØ§Øª
  quantity       Float @default(0) // Ø§Ù„ÙƒÙ…ÙŠØ© Ø§Ù„Ù…ØªØ­Ø±ÙƒØ© (Ø¯Ø§Ø¦Ù…Ø§Ù‹ Ù…ÙˆØ¬Ø¨Ø©)
  quantityBefore Float @default(0) // Ø§Ù„ÙƒÙ…ÙŠØ© Ù‚Ø¨Ù„ Ø§Ù„Ø­Ø±ÙƒØ©
  quantityAfter  Float @default(0) // Ø§Ù„ÙƒÙ…ÙŠØ© Ø¨Ø¹Ø¯ Ø§Ù„Ø­Ø±ÙƒØ©
  
  // Ø§Ù„ØªÙƒÙ„ÙØ© (ØªÙØ³Ø¬Ù„ ÙˆÙ‚Øª Ø§Ù„Ø­Ø±ÙƒØ©)
  unitPrice  Float? // Ø³Ø¹Ø± Ø§Ù„Ø´Ø±Ø§Ø¡ (Ù„Ù€ PURCHASE) Ø£Ùˆ Ù…ØªÙˆØ³Ø· Ø§Ù„ØªÙƒÙ„ÙØ© (Ù„Ù€ ISSUANCE)
  totalPrice Float? // quantity Ã— unitPrice
  
  // Ø§Ù„Ù…ÙˆØ§Ù‚Ø¹
  locationId     Int? // Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ (Ù„Ù„Ø´Ø±Ø§Ø¡ØŒ Ø§Ù„ØµØ±ÙØŒ Ø¥Ù„Ø®)
  fromLocationId Int? // Ù…Ù† Ù…ÙˆÙ‚Ø¹ (Ù„Ù€ TRANSFER ÙÙ‚Ø·)
  toLocationId   Int? // Ø¥Ù„Ù‰ Ù…ÙˆÙ‚Ø¹ (Ù„Ù€ TRANSFER ÙÙ‚Ø·)
  
  // Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø±Ø¨Ø·
  equipmentId           Int? // Ø§Ù„Ù…Ø¹Ø¯Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…Ø©
  projectId             Int? // Ø§Ù„Ù…Ø´Ø±ÙˆØ¹
  recipientEmployeeId   Int? // Ø§Ù„Ù…ÙˆØ¸Ù Ø§Ù„Ù…Ø³ØªÙ„Ù… (Ù„Ù„ØµØ±Ù)
  returnedByEmployeeId  Int? // Ø§Ù„Ù…ÙˆØ¸Ù Ø§Ù„Ù…Ø±Ø¬Ø¹ (Ù„Ù„Ø¥Ø±Ø¬Ø§Ø¹)
  returnedByEquipmentId Int? // Ø§Ù„Ù…Ø¹Ø¯Ø© Ø§Ù„Ù…Ø±Ø¬Ø¹Ø© (Ù„Ù„Ø¥Ø±Ø¬Ø§Ø¹)
  
  // Ø¨ÙŠØ§Ù†Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ©
  supplierName    String? // Ø§Ù„Ù…ÙˆØ±Ø¯
  invoiceNumber   String? // Ø±Ù‚Ù… Ø§Ù„ÙØ§ØªÙˆØ±Ø©
  referenceNumber String? // Ø±Ù‚Ù… Ù…Ø±Ø¬Ø¹ÙŠ Ø¹Ø§Ù…
  reason          String? // Ø³Ø¨Ø¨ (Ù„Ù„ØªØ³ÙˆÙŠØ©ØŒ Ø§Ù„Ø¥Ø±Ø¬Ø§Ø¹ØŒ Ø§Ù„Ù‡Ø§Ù„Ùƒ)
  adjustmentType  String? // "INCREASE", "DECREASE" (Ù„Ù„ØªØ³ÙˆÙŠØ©)
  notes           String?
  attachments     Json?
  
  // Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„ØªØ³Ø¬ÙŠÙ„
  transactionDate DateTime @default(now())
  createdAt       DateTime @default(now())
  createdBy       BigInt
  updatedBy       BigInt?
  approvedBy      BigInt?
  approvedAt      DateTime?
  
  // Ø§Ù„Ø¹Ù„Ø§Ù‚Ø§Øª
  item                INV_Item             @relation("ItemTransactions", fields: [itemId], references: [id])
  location            INV_StorageLocation? @relation("LocationTransactions", fields: [locationId], references: [id])
  fromLocation        INV_StorageLocation? @relation("FromTransactions", fields: [fromLocationId], references: [id])
  toLocation          INV_StorageLocation? @relation("ToTransactions", fields: [toLocationId], references: [id])
  equipment           Equipment?           @relation("SparePartTransactionEquipment", fields: [equipmentId], references: [id])
  project             Project?             @relation("SparePartTransactionProject", fields: [projectId], references: [id])
  recipientEmployee   Employee?            @relation("RecipientEmployee", fields: [recipientEmployeeId], references: [id])
  returnedByEmployee  Employee?            @relation("ReturnedByEmployee", fields: [returnedByEmployeeId], references: [id])
  returnedByEquipment Equipment?           @relation("ReturnedByEquipment", fields: [returnedByEquipmentId], references: [id])
  
  @@index([transactionNumber])
  @@index([itemId])
  @@index([transactionType])
  @@index([transactionDate])
  @@index([createdBy])
  @@index([recipientEmployeeId])
  @@index([returnedByEmployeeId])
  @@index([equipmentId])
  @@index([projectId])
  @@index([itemId, transactionDate])
  @@map("INV_Transaction")
}

// 6ï¸âƒ£ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù‚Ø·Ø¹ Ø§Ù„ØºÙŠØ§Ø± (Usage Records)
model INV_SparePartUsage {
  id             Int      @id @default(autoincrement())
  sparePartId    Int // Ø§Ù„Ø¢Ù† ÙŠØ´ÙŠØ± Ø¥Ù„Ù‰ itemId
  
  // Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…
  equipmentId    Int? // Ø§Ù„Ù…Ø¹Ø¯Ø© Ø§Ù„Ù…Ø±ÙƒØ¨ Ø¹Ù„ÙŠÙ‡Ø§
  equipmentName  String? // Ø§Ø³Ù… Ø§Ù„Ù…Ø¹Ø¯Ø©
  equipmentCode  String? // ÙƒÙˆØ¯ Ø§Ù„Ù…Ø¹Ø¯Ø©
  projectId      Int? // Ø§Ù„Ù…Ø´Ø±ÙˆØ¹
  projectName    String? // Ø§Ø³Ù… Ø§Ù„Ù…Ø´Ø±ÙˆØ¹
  
  // Ø§Ù„ÙƒÙ…ÙŠØ§Øª ÙˆØ§Ù„ØªÙˆØ§Ø±ÙŠØ®
  quantity       Int
  installDate    DateTime @default(now())
  expectedLife   Int? // Ø§Ù„Ø¹Ù…Ø± Ø§Ù„Ù…ØªÙˆÙ‚Ø¹ Ø¨Ø§Ù„Ø£ÙŠØ§Ù…/Ø§Ù„Ø³Ø§Ø¹Ø§Øª
  
  // Ø§Ù„Ø­Ø§Ù„Ø©
  status         String   @default("IN_USE") // "IN_USE", "REPLACED", "FAILED"
  replacedDate   DateTime?
  failureReason  String?
  
  // Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„ÙÙ†ÙŠ
  installedByEmployeeId Int? // Ù…Ù† Ù‚Ø§Ù… Ø¨Ø§Ù„ØªØ±ÙƒÙŠØ¨ (Employee ID)
  installedByName String? // Ø§Ø³Ù… Ø§Ù„ÙÙ†ÙŠ
  notes          String?
  
  // Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„ØªØ³Ø¬ÙŠÙ„
  createdAt      DateTime @default(now())
  updatedAt      DateTime @updatedAt
  
  // Ø§Ù„Ø¹Ù„Ø§Ù‚Ø§Øª
  item      INV_Item  @relation("SparePartUsages", fields: [sparePartId], references: [id])
  equipment Equipment? @relation("SparePartUsageEquipment", fields: [equipmentId], references: [id])
  project   Project?   @relation("SparePartUsageProject", fields: [projectId], references: [id])
  installer Employee?  @relation("SparePartUsageInstaller", fields: [installedByEmployeeId], references: [id])
  
  @@index([sparePartId])
  @@index([equipmentId])
  @@index([projectId])
  @@index([status])
  @@index([installDate])
  @@index([installedByEmployeeId])
  @@map("INV_SparePartUsage")
}

// 7ï¸âƒ£ Ø³Ø¬Ù„ Ø§Ù„Ù‡ÙˆØ§Ù„Ùƒ/Ø§Ù„ØªØ§Ù„Ù (Damage Records)
model INV_DamageRecord {
  id              Int      @id @default(autoincrement())
  recordNumber    String   @unique // "DMG-20251109-001"
  sparePartId     Int // Ø§Ù„Ø¢Ù† ÙŠØ´ÙŠØ± Ø¥Ù„Ù‰ itemId
  
  // ØªÙØ§ØµÙŠÙ„ Ø§Ù„ØªÙ„Ù
  damageType      String // "EXPIRED", "BROKEN", "DEFECTIVE", "WATER_DAMAGE", "CORROSION", "OTHER"
  damageDate      DateTime @default(now())
  discoveredBy    BigInt // Ù…Ù† Ø§ÙƒØªØ´Ù Ø§Ù„ØªÙ„Ù
  
  // Ø§Ù„ÙƒÙ…ÙŠØ§Øª ÙˆØ§Ù„Ù‚ÙŠÙ…
  quantity        Int // Ø§Ù„ÙƒÙ…ÙŠØ© Ø§Ù„ØªØ§Ù„ÙØ©
  unitPrice       Float // Ø³Ø¹Ø± Ø§Ù„ÙˆØ­Ø¯Ø© ÙˆÙ‚Øª Ø§Ù„ØªÙ„Ù
  totalValue      Float // Ø§Ù„Ù‚ÙŠÙ…Ø© Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠØ© Ù„Ù„Ù‡Ø§Ù„Ùƒ
  
  // Ø§Ù„Ø£Ø³Ø¨Ø§Ø¨ ÙˆØ§Ù„ØªÙØ§ØµÙŠÙ„
  damageReason    String // Ø³Ø¨Ø¨ Ø§Ù„ØªÙ„Ù Ø§Ù„ØªÙØµÙŠÙ„ÙŠ
  damageSeverity  String   @default("MEDIUM") // "LOW", "MEDIUM", "HIGH", "TOTAL_LOSS"
  isRepairable    Boolean  @default(false) // Ù‡Ù„ Ù‚Ø§Ø¨Ù„Ø© Ù„Ù„Ø¥ØµÙ„Ø§Ø­ØŸ
  
  // Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª Ø§Ù„Ù…ØªØ®Ø°Ø©
  actionTaken     String? // "REPAIR", "DISPOSE", "PENDING"
  actionDate      DateTime?
  actionBy        BigInt?
  recoveredValue  Float    @default(0) // Ø§Ù„Ù‚ÙŠÙ…Ø© Ø§Ù„Ù…Ø³ØªØ±Ø¯Ø© (Ù…Ù† Ø¨ÙŠØ¹ Ø®Ø±Ø¯Ø© Ù…Ø«Ù„Ø§Ù‹)
  
  // Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø§Øª
  approvalStatus  String   @default("PENDING") // "PENDING", "APPROVED", "REJECTED"
  approvedBy      BigInt?
  approvedAt      DateTime?
  
  // Ø§Ù„Ù…Ø±ÙÙ‚Ø§Øª ÙˆØ§Ù„Ù…Ù„Ø§Ø­Ø¸Ø§Øª
  photos          Json? // ØµÙˆØ± Ø§Ù„ØªÙ„Ù
  notes           String?
  
  // Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„ØªØ³Ø¬ÙŠÙ„
  createdAt       DateTime @default(now())
  updatedAt       DateTime @updatedAt
  
  // Ø§Ù„Ø¹Ù„Ø§Ù‚Ø§Øª
  item INV_Item @relation("SparePartDamages", fields: [sparePartId], references: [id])
  
  @@index([recordNumber])
  @@index([sparePartId])
  @@index([damageType])
  @@index([damageDate])
  @@index([approvalStatus])
  @@index([actionTaken])
  @@index([discoveredBy])
  @@map("INV_DamageRecord")
}

// 8ï¸âƒ£ Ø¹Ù…Ù„ÙŠØ§Øª Ø§Ù„Ø¬Ø±Ø¯ (Inventory Audit) - Ù…ÙˆØ­Ø¯ Ù„Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø®Ø§Ø²Ù†
model INV_InventoryAudit {
  id              Int      @id @default(autoincrement())
  auditNumber     String   @unique // "AUD-20251111-00001"
  
  // Ù†ÙˆØ¹ Ø§Ù„Ù…Ø®Ø²Ù† - Ù…ØªØ¹Ø¯Ø¯ Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…Ø§Øª â­
  warehouseType   String   // "SPARE_PARTS", "OILS_GREASE", "FUEL", "TOOLS"
  
  // Ù†ÙˆØ¹ Ø§Ù„Ø¬Ø±Ø¯
  auditType       String   // "FULL" (Ø´Ø§Ù…Ù„), "CATEGORY" (ÙØ¦Ø©), "LOCATION" (Ù…ÙˆÙ‚Ø¹), "SINGLE_ITEM" (ØµÙ†Ù ÙˆØ§Ø­Ø¯)
  
  // Ù†Ø·Ø§Ù‚ Ø§Ù„Ø¬Ø±Ø¯ (Ø­Ø³Ø¨ Ø§Ù„Ù†ÙˆØ¹)
  categoryId      Int?     // Ù„Ù„ÙØ¦Ø§Øª
  locationId      Int?     // Ù„Ù„Ù…ÙˆØ§Ù‚Ø¹
  itemId          Int?     // Ù„ØµÙ†Ù ÙˆØ§Ø­Ø¯
  itemCode        String?  // ÙƒÙˆØ¯ Ø§Ù„ØµÙ†Ù (Ù„Ù„Ø³Ù‡ÙˆÙ„Ø©)
  
  // Ø§Ù„Ø­Ø§Ù„Ø©
  status          String   @default("IN_PROGRESS") // "IN_PROGRESS", "COMPLETED", "CANCELLED"
  
  // Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª
  totalItems      Int      @default(0) // Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø£ØµÙ†Ø§Ù
  itemsChecked    Int      @default(0) // Ø§Ù„Ø£ØµÙ†Ø§Ù Ø§Ù„Ù…Ø¬Ø±Ø¯Ø©
  itemsWithDiff   Int      @default(0) // Ø§Ù„Ø£ØµÙ†Ø§Ù Ø¨Ù‡Ø§ ÙØ±ÙˆÙ‚Ø§Øª
  
  // Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„ÙØ±ÙˆÙ‚Ø§Øª
  totalShortage   Int      @default(0) // Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø¹Ø¬Ø²
  totalSurplus    Int      @default(0) // Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø²ÙŠØ§Ø¯Ø©
  
  // Ø§Ù„ØªÙˆØ§Ø±ÙŠØ®
  auditDate       DateTime @default(now())
  startedAt       DateTime @default(now())
  completedDate   DateTime?
  
  // Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„
  createdBy       BigInt
  completedBy     BigInt?
  
  // Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø¹Ø§Ù…Ø©
  notes           String?
  
  // Ø§Ù„Ø¹Ù†Ø§ØµØ± Ø§Ù„Ù…Ø¬Ø±Ø¯Ø©
  items           INV_InventoryAuditItem[]
  
  @@index([auditNumber])
  @@index([warehouseType])
  @@index([status])
  @@index([auditType])
  @@index([auditDate])
  @@index([createdBy])
  @@map("INV_InventoryAudit")
}

// 9ï¸âƒ£ Ø¹Ù†Ø§ØµØ± Ø§Ù„Ø¬Ø±Ø¯ (Audit Items) - Ù…ÙˆØ­Ø¯ Ù„Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø®Ø§Ø²Ù†
model INV_InventoryAuditItem {
  id                Int      @id @default(autoincrement())
  auditId           Int
  
  // Ù…Ø¹Ø±Ù Ø§Ù„ØµÙ†Ù - Ù…ØªØ¹Ø¯Ø¯ Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…Ø§Øª â­
  itemId            Int // ÙŠØ´ÙŠØ± Ø¥Ù„Ù‰ INV_Item
  itemType          String   // "SPARE_PART", "OIL", "FUEL", "TOOL"
  itemCode          String   // ÙƒÙˆØ¯ Ø§Ù„ØµÙ†Ù
  itemName          String   // Ø§Ø³Ù… Ø§Ù„ØµÙ†Ù
  
  // Ø§Ù„ÙƒÙ…ÙŠØ§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©
  systemQuantity    Float // Ø§Ù„ÙƒÙ…ÙŠØ© ÙÙŠ Ø§Ù„Ù†Ø¸Ø§Ù…
  actualQuantity    Float // Ø§Ù„ÙƒÙ…ÙŠØ© Ø§Ù„ÙØ¹Ù„ÙŠØ© Ø§Ù„Ù…Ø¬Ø±Ø¯Ø©
  difference        Float // Ø§Ù„ÙØ±Ù‚ (actual - system)
  
  // ØªÙØ§ØµÙŠÙ„ Ø¥Ø¶Ø§ÙÙŠØ© (JSON Ù…Ø±Ù†) â­
  systemDetails     Json? // ØªÙØ§ØµÙŠÙ„ Ø§Ù„ÙƒÙ…ÙŠØ© ÙÙŠ Ø§Ù„Ù†Ø¸Ø§Ù…
  actualDetails     Json? // ØªÙØ§ØµÙŠÙ„ Ø§Ù„ÙƒÙ…ÙŠØ© Ø§Ù„ÙØ¹Ù„ÙŠØ©
  
  // Ø§Ù„Ù…ÙˆÙ‚Ø¹ ÙˆØ§Ù„ÙØ¦Ø©
  locationId        Int?
  locationName      String?
  categoryId        Int?
  categoryName      String?
  
  // Ø§Ù„ÙˆØ­Ø¯Ø©
  unit              String   @default("Ù‚Ø·Ø¹Ø©")
  
  // Ø­Ø§Ù„Ø© Ø§Ù„ØµÙ†Ù
  hasDiscrepancy    Boolean  @default(false) // Ù‡Ù„ ÙŠÙˆØ¬Ø¯ ÙØ±Ù‚ØŸ
  discrepancyType   String?  // "SHORTAGE" (Ø¹Ø¬Ø²), "SURPLUS" (Ø²ÙŠØ§Ø¯Ø©), "MATCH" (Ù…ØªØ·Ø§Ø¨Ù‚)
  
  // Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø®Ø§ØµØ© Ø¨Ø§Ù„ØµÙ†Ù
  notes             String?
  
  // Ø§Ù„ØªÙˆØ§Ø±ÙŠØ®
  checkedAt         DateTime @default(now())
  
  // Ø§Ù„Ø¹Ù„Ø§Ù‚Ø§Øª
  audit INV_InventoryAudit @relation(fields: [auditId], references: [id], onDelete: Cascade)
  item  INV_Item           @relation("AuditItems", fields: [itemId], references: [id])
  
  @@index([auditId])
  @@index([itemType])
  @@index([itemId])
  @@index([hasDiscrepancy])
  @@index([discrepancyType])
  @@map("INV_InventoryAuditItem")
}
