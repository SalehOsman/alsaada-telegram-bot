# **๐ ุงูููุงุตูุงุช ุงูุฅุฏุงุฑูุฉ ูุงูุจุฑูุฌูุฉ \- ูุณู ุงููุฎุงุฒู**

ุงูุฅุตุฏุงุฑ: 1.0  
ุงูุชุงุฑูุฎ: 8 ููููุจุฑ 2025  
ุงูุบุฑุถ: ุชุญุฏูุฏ ุงููุจุงุฏุฆ ุงูุญุงููุฉ (Methodology) ูููููุฉุ ุจุฑูุฌุฉุ ุฅุฏุงุฑุฉุ ูุงุฎุชุจุงุฑ ูุณู ุงููุฎุงุฒู ูุถูุงู ุชูุงููู ูุน ุงููุธุงู ุงูุญุงูู ูุชูููู ุนููู.

## **1\. ุงูููุฏูุฉ**

ููุฏู ูุฐุง ุงููุณุชูุฏ ุฅูู ูุถุน ุงูููุงุตูุงุช ุงููููุฉ ูุงูุฅุฏุงุฑูุฉ ูุจูุงุก ูุณู ุงููุฎุงุฒู (inventory-management). ุงููุนูุงุฑ ุงูุฐูุจู ูููุฌุงุญ ูู ุงูุงูุชุฒุงู ุจููุณ ูุจุงุฏุฆ ุงูููุฉ ุงูููุฌูุฏุฉ ูู ูุณู ุดุฆูู ุงูุนุงูููู \[cite: Documentation\_Pro/HR-Management/01\_SYSTEM\_OVERVIEW.md\]ุ ููู: **ุงููุญุฏุงุชูุฉ (Modularity)**ุ **ูุงุจููุฉ ุงูุชูุณุน (Scalability)**ุ **ุงูุฃุชูุชุฉ (Automation)**ุ ู **ุงูุชูุงูู ุงูุนููู (Deep Integration)**.

ููุชููู ุนูู ูุฐุง ุงููุนูุงุฑุ ุณูุถูู ูุณู ุงููุฎุงุฒู ูุจุฏุฃูู ุฅุถุงูููู:

1. **ุชุชุจุน ุงูุชูููุฉ ุงูุตุงุฑู (Strict Costing):** ูู ุญุฑูุฉ ูุฌุจ ุฃู ุชูุณุนุฑ.  
2. **ุงูุชุฏููู ุงููุทูู (Absolute Auditing):** ูุง ูููู ุชุนุฏูู ุงูุฃุฑุตุฏุฉุ ุจู ูุชู ุฅุถุงูุฉ "ุญุฑูุงุช" ุชุนุฏู ุนูููุง.

## **2\. ููุงุตูุงุช ุฅุฏุงุฑุฉ ุงููุณู ูุงูุตูุงุญูุงุช**

ูุฌุจ ุฃู ูุชุจุน ูุณู ุงููุฎุงุฒู ููุณ ูููู ุฅุฏุงุฑุฉ ุงูุตูุงุญูุงุช ุงูููุฌูุฏ ูู ูุณู ุดุฆูู ุงูุนุงูููู \[cite: Documentation\_Pro/HR-Management/16\_PERMISSIONS\_AND\_DEPARTMENTS.md\].

1. **ุงูุชุณุฌูู ูู DepartmentConfig:**  
   * ูุฌุจ ุชุณุฌูู ุงููุณู ุงูุฑุฆูุณู ูู ุฌุฏูู DepartmentConfig (ุฃู ูุง ููุงุซูู).  
   * code: inventory-management  
   * name: "ุฅุฏุงุฑุฉ ุงููุฎุงุฒู"  
   * minRole: ADMIN (ุฃู ุญุณุจ ุงูุญุงุฌุฉ).  
2. **ุงูุชุณุฌูู ูู SubFeatureConfig:**  
   * **ููููุน** ุฅูุดุงุก ุฃู ูุธููุฉ (Handler) ุจุฏูู ุชุณุฌูููุง ุฃููุงู ูู "ููุฒุฉ ูุฑุนูุฉ" (SubFeatureConfig).  
   * **ุฃูุซูุฉ ุนูู ุงูุฃููุงุฏ (Codes):**  
     * inv:setup:items (ุฅุฏุงุฑุฉ ุงูุฃุตูุงู)  
     * inv:receive:new (ุงุณุชูุงู ูุดุชุฑูุงุช)  
     * inv:dispense:consumption (ุตุฑู ููุงุณุชููุงู)  
     * inv:custody:issue (ุตุฑู ุนูุฏุฉ)  
     * inv:custody:return (ุฅุฑุฌุงุน ุนูุฏุฉ)  
     * inv:custody:report\_lost (ุฎุตู ุนูุฏุฉ ููููุฏุฉ \- *ุตูุงุญูุฉ HR*)  
     * inv:reports:stock\_value (ุชูุฑูุฑ ูููุฉ ุงููุฎุฒูู \- *ุตูุงุญูุฉ SUPER\_ADMIN*)  
3. **ุงูุญูุงูุฉ ุงูุฅูุฒุงููุฉ ุจู Middleware:**  
   * ูุฌุจ ุญูุงูุฉ **ุฌููุน** ุงูู Handlers ุงูุฎุงุตุฉ ุจุงููุณู ุจุงุณุชุฎุฏุงู checkAccessMiddleware (ุฃู ูุง ููุงุซูู)ุ ูุงูุฐู ูุชุญูู ูู isEnabled ู minRole ู userRole ูุจู ุชูููุฐ ุฃู ููุฏ.  
4. **ุงูุฃุฏูุงุฑ (Roles):**  
   * ูุฌุจ ุชุนุฑูู ุฃุฏูุงุฑ ูุงุถุญุฉ ุชุชุฌุงูุฒ ADMIN ู SUPER\_ADMIN ุฅุฐุง ูุฒู ุงูุฃูุฑ (ูุซู STORE\_KEEPER \- ุฃููู ูุฎุฒู) ูุฑุจุท ุตูุงุญูุงุชู ุจุงูููุฒุงุช ุงููุฑุนูุฉ.

## **3\. ููุงุตูุงุช ูููููุฉ ุงููููุงุช (File Structure)**

ูุถูุงู ุงูุงุชุณุงูุ ูุฌุจ ุฃู ุชุนูุณ ูููููุฉ ูููุงุช ูุณู ุงููุฎุงุฒู ูููููุฉ ูุณู ุดุฆูู ุงูุนุงูููู (hr-management).

**ุงููููุน ุงูููุชุฑุญ:** src/bot/features/inventory-management/

/src/bot/features/inventory-management/  
โโโ handlers/                 \# (ูููุงุช ุงููุธุงุฆู ุงูุนุงููุฉ \- ูุงุฌูุฉ ุงูุจูุช)  
โ   โโโ setup/                \# (ุฅุนุฏุงุฏุงุช ุงูุฃุตูุงูุ ุงููุฎุงุฒูุ ุงูููุฑุฏูู)  
โ   โโโ receiving/            \# (ุงูุงุณุชูุงู ูุฃูุงูุฑ ุงูุดุฑุงุก)  
โ   โโโ dispensing/           \# (ุงูุตุฑู ููุงุณุชููุงู)  
โ   โโโ custody/              \# (ุงูุนูุฏ \- ุตุฑูุ ุฅุฑุฌุงุนุ ููุฏุงู)  
โ   โโโ reports/              \# (ุงูุชูุงุฑูุฑ)  
โ   โโโ tools/                \# (ุงูุฌุฑุฏุ ุงูุชุณููุงุช ุงููุฏููุฉ)  
โ  
โโโ services/                 \# (ูููุงุช ุงูููุทู ุงูุจุฑูุฌู ุงููุนูุฏ \- Business Logic)  
โ   โโโ costing.service.ts    \# (ููุทู ุญุณุงุจ ูุชูุณุท ุงูุชูููุฉ WAC)  
โ   โโโ stock-trx.service.ts  \# (ุงูุฎุฏูุฉ ุงูุฃุณุงุณูุฉ ูุฅูุดุงุก ุงูุญุฑูุงุช ูุชุญุฏูุซ ุงูุฑุตูุฏ)  
โ   โโโ custody.service.ts    \# (ููุทู ุฑุจุท ุงูุนูุฏุฉ ุจุงูููุธููู ูุงูุฑูุงุชุจ)  
โ   โโโ inventory.service.ts  \# (ุฎุฏูุงุช ุนุงูุฉ)  
โ  
โโโ utils/                    \# (ุฃุฏูุงุช ูุณุงุนุฏุฉ)  
โ   โโโ inventory-excel-generator.ts \# (ูููุฏ ุชูุงุฑูุฑ ุงูุฅูุณู)  
โ  
โโโ types/                    \# (ุชุนุฑูู ุงูุฃููุงุน)  
โ   โโโ inventory.types.ts  
โ  
โโโ middleware/               \# (ูููุงุช ุงูุตูุงุญูุงุช ุงูุฎุงุตุฉ ุจุงููุณู ุฅู ูุฌุฏุช)  
โ  
โโโ config.ts                 \# (ููู ุชุฌููุน ูุชุณุฌูู ุงูููุฒุงุช ูู SubFeatureConfig)  
โโโ index.ts                  \# (ููุทุฉ ุงูุฏุฎูู ูููุณู)

## **4\. ููุงุตูุงุช ุงูุชูููุฏ ูุงูููุฏุณุฉ (Coding & Architecture)**

1. **ุงููุตู ุจูู ุงููุงุฌูุฉ ูุงูููุทู (Separation of Concerns):**  
   * **ูููุงุช handlers/\*.ts:** ูุณุคููุฉ *ููุท* ุนู ูุงุฌูุฉ ุงูุจูุช (ุฅุฑุณุงู ุงูุฑุณุงุฆูุ ุนุฑุถ ุงูุฃุฒุฑุงุฑุ ุงุณุชูุจุงู ุงูุฑุฏูุฏุ ุฌูุน ุงูุจูุงูุงุช ูู ุงููุณุชุฎุฏู).  
   * **ูููุงุช services/\*.ts:** ูุณุคููุฉ *ููุท* ุนู ุงูููุทู ุงูุจุฑูุฌู ุงููุนูุฏ (Database Queries, Calculations, prisma.$transaction).  
   * *ูุซุงู: inventory-receive.handler.ts ูุฌูุน ุจูุงูุงุช ุงููุงุชูุฑุฉุ ุซู ูุณุชุฏุนู costing.service.ts ูุชูููุฐ ุนูููุฉ ุงูุญุณุงุจ ูุงูุชุณุฌูู ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช.*  
2. **ุงููุนุงููุงุช ุงูุฐุฑูุฉ (Atomic Transactions):**  
   * **ุฅูุฒุงูู:** ุฃู ุนูููุฉ ุชุชุถูู ุฃูุซุฑ ูู ุฎุทูุฉ ูุชุงุจุฉ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช (ูุซู ุฅุถุงูุฉ StockTransaction ูุชุญุฏูุซ Stock) ูุฌุจ ุฃู ุชููู ูุบููุฉ ุจุงููุงูู ุฏุงุฎู prisma.$transaction(\[...\]).  
   * **ุงููุฏู:** ุถูุงู ุฃูู ูู ุญุงูุฉ ูุดู ุฎุทูุฉ ูุงุญุฏุฉุ ูุชู ุงูุชุฑุงุฌุน (Rollback) ุนู ุงูุนูููุฉ ุจุฃููููุงุ ููุง ูููุน ุชูู ุงูุจูุงูุงุช (Data Corruption). ูุฐุง ุญุงุณู ูู ุงูุฃูุธูุฉ ุงููุงููุฉ ูุงููุฎุฒููุฉ.  
3. **ุงูุชุฏููู ุฃููุงู (Audit-First Principle):**  
   * ูุง ูุชู "ุชุนุฏูู" (UPDATE) ุงูุฑุตูุฏ ูู ุฌุฏูู Stock ุจุดูู ุนุดูุงุฆู.  
   * **ุงูุขููุฉ:** ูุชู *ุฏุงุฆูุงู* ุฅูุดุงุก ุณุฌู StockTransaction (ุญุฑูุฉ) ุฃููุงู. ุจุนุฏ ูุฌุงุญ ุฅูุดุงุก ุงูุญุฑูุฉุ ูุชู ุชุญุฏูุซ ุฌุฏูู Stock (ุงููููุฉ ูุงููุชูุณุท) ุจูุงุกู ุนูู ูุฐู ุงูุญุฑูุฉ. ูุฐุง ูุชุจุน **ุณููุงุฑูู 2** \[cite: Documentation\_Pro/Inventory-Management/03\_USER\_FLOWS\_AND\_SCENARIOS.md\].  
4. **ููููุน ุงูุณูุงุณู ุงูุณุญุฑูุฉ (No Magic Strings):**  
   * ูุฌุจ ุฃู ุชุฃุชู ุฌููุน ุงููุตูุต ุงูููุฌูุฉ ูููุณุชุฎุฏู ูู ูููุงุช ุงูุชุฑุฌูุฉ (.ftl).  
   * ูุฌุจ ุฃู ูุชู ุฅูุดุงุก ุฌููุน ุจูุงูุงุช callback\_data ููุฃุฒุฑุงุฑ ุนุจุฑ CallbackDataParser (ุฃู ูุง ููุงุซูู) ูุถูุงู ุงูุงุชุณุงู.  
5. **ุงูุชูุซูู ุงููุถูู (JSDoc/TSDoc):**  
   * ูู ุฏุงูุฉ (Function) ุฌุฏูุฏุฉุ ุฎุงุตุฉ ูู ูููุงุช servicesุ ูุฌุจ ุฃู ุชุญุชูู ุนูู ุชุนูููุงุช TSDoc ุชุดุฑุญ (ูุงุฐุง ุชูุนูุ ูุง ูู ุงููุฏุฎูุงุชุ ููุง ูู ุงููุฎุฑุฌุงุช).

## **5\. ููุงุตูุงุช ุงูุงุฎุชุจุงุฑ (Testing)**

ูุธุฑุงู ููุญุณุงุณูุฉ ุงูุนุงููุฉ ูุญุณุงุจุงุช ุงูุชูููุฉ ูุงูุฃุฑุตุฏุฉุ ูุฌุจ ุฃู ุชููู ุงูุงุฎุชุจุงุฑุงุช ุฃููููุฉ ูุตูู.

1. **ุงุฎุชุจุงุฑุงุช ุงููุญุฏุฉ (Unit Tests):**  
   * **ุฅูุฒุงูู:** ูุฌุจ ูุชุงุจุฉ ุงุฎุชุจุงุฑุงุช ูุญุฏุฉ ุดุงููุฉ ูููู costing.service.ts.  
   * **ุงููุฏู:** ุงุฎุชุจุงุฑ ุฏุงูุฉ ุญุณุงุจ ูุชูุณุท ุงูุชูููุฉ ุงููุฑุฌุญ (WAC) \[cite: Documentation\_Pro/Inventory-Management/03\_USER\_FLOWS\_AND\_SCENARIOS.md\] ูู ุณููุงุฑูููุงุช ูุฎุชููุฉ (ูุฎุฒูู ุตูุฑูุ ูุฎุฒูู ููุฌูุฏุ ุฃุณุนุงุฑ ุดุฑุงุก ูุฎุชููุฉ) ุจุงุณุชุฎุฏุงู ุจูุงูุงุช ููููุฉ (Mock Data).  
   * **ุงูุชูููุฉ:** ุงุณุชุฎุฏุงู jest.mock ูุนุฒู ุงูุฎุฏูุฉ ุนู ูุงุนุฏุฉ ุงูุจูุงูุงุช.  
2. **ุงูุงุฎุชุจุงุฑุงุช ุงูุชูุงูููุฉ (Integration Tests):**  
   * **ุฅูุฒุงูู:** ูุฌุจ ุงุฎุชุจุงุฑ ุงูุชุฏููุงุช (Flows) ุงูุชู ุชุณุชุฎุฏู prisma.$transaction.  
   * **ุงููุฏู:** ุงุฎุชุจุงุฑ **ุณููุงุฑูู 2** (ุงูุงุณุชูุงู) \[cite: Documentation\_Pro/Inventory-Management/03\_USER\_FLOWS\_AND\_SCENARIOS.md\] ู **ุณููุงุฑูู 3** (ุงูุตุฑู) \[cite: Documentation\_Pro/Inventory-Management/03\_USER\_FLOWS\_AND\_SCENARIOS.md\] ุจุงููุงูู ููุชุฃูุฏ ูู ุฃู StockTransaction ุชููุดุฃุ ู Stock ููุญุฏูุซ ุจุดูู ุตุญูุญุ ูุฃู TransactionLink ูุชู ุฑุจุทู.  
3. **ุงุฎุชุจุงุฑุงุช ุงูุฑุจุท (Bridge Tests):**  
   * **ุฅูุฒุงูู:** ุงุฎุชุจุงุฑ **ุณููุงุฑูู 5** (ููุฏุงู ุงูุนูุฏุฉ) \[cite: Documentation\_Pro/Inventory-Management/03\_USER\_FLOWS\_AND\_SCENARIOS.md\] ููุชุฃูุฏ ูู ุฃู ุฅุบูุงู ุงูุนูุฏุฉ ูู ูุณู ุงููุฎุงุฒู ูุคุฏู *ุจูุฌุงุญ* ุฅูู ุฅูุดุงุก "ุฏูู" (EMPLOYEE\_DEBT) ูู ูุณู ุดุฆูู ุงูุนุงูููู (HR\_Transaction \[cite: Documentation\_Pro/HR-Management/13\_SETTLEMENTS\_AND\_TRANSACTIONS.md\]).

## **6\. ููุงุตูุงุช ุงูุชูุซูู (Documentation)**

1. **ุงูุชูุซูู ุงูููู (Technical Docs):** ูุฌุจ ุชุญุฏูุซ ุฌููุน ูููุงุช Documentation\_Pro/Inventory-Management/ (ูุซู 02\_DATABASE\_SCHEMA.md \[cite: Documentation\_Pro/Inventory-Management/02\_DATABASE\_SCHEMA.md\] ู 03\_USER\_FLOWS\_AND\_SCENARIOS.md \[cite: Documentation\_Pro/Inventory-Management/03\_USER\_FLOWS\_AND\_SCENARIOS.md\]) ุจุงูุชูุงุฒู ูุน ูุชุงุจุฉ ุงูููุฏ.  
2. **ุฏููู ุงููุณุชุฎุฏู (User Guide):** ุนูุฏ ุงูุงูุชูุงุกุ ูุฌุจ ุฅูุดุงุก 08\_USER\_GUIDE.md (ูุดุงุจู ูููู HR \[cite: Documentation\_Pro/HR-Management/08\_USER\_GUIDE.md\]) ูุดุฑุญ ูุฃููู ุงููุฎุฒู ูุงููุฏูุฑ ููููุฉ ุงุณุชุฎุฏุงู ุงููุธุงุฆู ุจูุบุฉ ุจุณูุทุฉ.