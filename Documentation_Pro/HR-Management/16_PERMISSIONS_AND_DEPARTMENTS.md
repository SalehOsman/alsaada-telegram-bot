# 16. نظام الصلاحيات والأقسام (Permissions & Departments System)

---

## مقدمة

نظام الصلاحيات والأقسام يتيح إدارة دقيقة لصلاحيات المستخدمين، تعيين مدراء للأقسام والميزات، وتحديد حدود الوصول بدقة.

---

## الأهداف الرئيسية للنظام
- إدارة الصلاحيات على مستوى الأقسام والميزات.
- تعيين مدراء للأقسام والميزات الفرعية.
- سجل تغيير الصلاحيات.

---

## الهيكل العام للنظام

- **Handlers رئيسية:**
  - section-management.handler.ts
  - section-permissions.handler.ts
  - department-management.handler.ts
- **الجداول المرتبطة:**
  - DepartmentConfig
  - DepartmentAdmin
  - SubFeatureConfig
  - SubFeatureAdmin

---

## 1. إدارة الأقسام (Department Management)

### الوظيفة:
- تفعيل/تعطيل الأقسام.
- تعيين مدراء على الأقسام.
- تحديد الحد الأدنى للوصول.

### السيناريو:
1. عرض جميع الأقسام.
2. تعيين أو تغيير مدير القسم.
3. تفعيل أو تعطيل قسم.

### مثال واجهة برمجية:
```
[إدارة الأقسام]
- القسم: المالية
- المدير: محمد حسن
- الحالة: مفعل
[تغيير المدير] [تعطيل]
```

---

## 2. إدارة الصلاحيات (Permissions Management)

### الوظيفة:
- تعيين مدراء على الميزات الفرعية.
- تحديد صلاحيات دقيقة لكل مستخدم.
- سجل تغيير الصلاحيات.

### السيناريو:
1. اختيار ميزة فرعية.
2. تعيين مدير أو تعديل الصلاحيات.
3. حفظ التغييرات.

### مثال واجهة برمجية:
```
[إدارة الصلاحيات]
- الميزة: الرواتب
- المدير: أحمد علي
- الصلاحيات: عرض، تعديل، تصدير
[حفظ]
```

---

## 3. الجداول المرتبطة (Database Tables)

### DepartmentConfig
- إعدادات الأقسام.
- الحقول: id, name, isActive, minAccessLevel

### DepartmentAdmin
- مدراء الأقسام.
- الحقول: id, departmentId, userId, assignedAt

### SubFeatureConfig
- الميزات الفرعية.
- الحقول: id, name, departmentId, isActive

### SubFeatureAdmin
- مدراء الميزات الفرعية.
- الحقول: id, subFeatureId, userId, assignedAt

---

## 4. أفضل الممارسات
- مراجعة الصلاحيات بشكل دوري.
- تفعيل سجل تغيير الصلاحيات.
- تعيين مدراء احتياطيين للأقسام.

---

## 5. ملخص

نظام الصلاحيات والأقسام يوفر تحكمًا دقيقًا في الوصول والإدارة، مع سجل تغييرات مفصل.

---

**آخر تحديث:** 7 نوفمبر 2025
