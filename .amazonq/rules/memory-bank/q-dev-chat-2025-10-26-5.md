F:_Alsaada_Telegram_Bot\telegram-bot-template-main.amazonq\rules\memory-bank
ุงุฑูุฏ ุงุณุชููุงู ุงููุญุงุฏุซุฉ ุงูุณุงุจูุฉ ุญูุช ุชููููุง
ุฑุงุฌุน ุงููุญุงุฏุซุฉ ุงูุณุงุจูุฉ ูุชุญุฏูุฏ ููุทุฉ ุงูุชููู ูุงููุดููุฉ ุงูุชู ููุง ูุนูู ุนูู ุญููุง

---

ุจูุงุกู ุนูู ูุฑุงุฌุนุฉ ุงููุญุงุฏุซุฉ ุงูุณุงุจูุฉุ ุขุฎุฑ ููุทุฉ ุชููููุง ุนูุฏูุง ูุงูุช:

## ๐ ุงููุดููุฉ ุงูุฃุฎูุฑุฉ:
ููุง ูุนูู ุนูู **ุฅูุดุงุก handler ุฌุฏูู ุฃุฏูุงุฑ ุงูุฅุฌุงุฒุงุช** ููู ุญุฏุซ ุฎุทุฃ "Too much context loaded" ูุชู ูุณุญ ุงูุณูุงู.

## ๐ ุงููุชุทูุจุงุช ุงููุทููุจุฉ:
1. โ ุนุฑุถ ูุงุฆูุฉ ุงูุนุงูููู: **ุงุณู ุงูุดูุฑุฉ (ุงููุธููุฉ) - ุชุงุฑูุฎ ุงูุฅุฌุงุฒุฉ ุงููุงุฏูุฉ**
2. โ ุชุตููู ูููู:
   - ๐ด ุฃุญูุฑ: ุฅุฌุงุฒุงุช ุฎูุงู 3 ุฃูุงู
   - ๐ก ุฃุตูุฑ: ุฅุฌุงุฒุงุช ุฎูุงู ุฃุณุจูุน
   - ๐ข ุฃุฎุถุฑ: ุจุงูู ุงููุงุฆูุฉ
3. โ **ูุง ูุธูุฑ ูู ูู ุฅุฌุงุฒุฉ ุญุงููุงู**
4. โ ุนูุฏ ูุชุญ ูุนูููุงุช ุนุงูู: ุฃุฒุฑุงุฑ **ุชุฃุฌูู ุงูุฅุฌุงุฒุฉ** ู **ุตุฑู ุจุฏู ุฅุฌุงุฒุฉ**
5. โ ููุงุชุฑ ูุฅุญุตุงุฆูุงุช

---

ุฏุนูู ุฃุชุญูู ูู ุงูููู ุงูุญุงูู ูุฌุฏูู ุงูุฃุฏูุงุฑ:

---

ุฎุฐุฎ ููุณุช ุงุฎุฑ ููุทุฉ
q-dev-chat-2025-10-26-4.md
ุฑุงุฌุน ุงูููู ููููุงุชู ูุชุนุฑู ุจุงูุชุญุฏูุฏ ุงุฎุฑ ููุทุฉ

---

ุจูุงุกู ุนูู ูุฑุงุฌุนุฉ ุงููููุ **ุขุฎุฑ ููุทุฉ ุชููููุง ุนูุฏูุง** ูุงูุช:

## ๐ ุงููุดููุฉ ุงูุฃุฎูุฑุฉ:
**ุงูุจูุช ูุชููู ุนูุฏ ุฅุฏุฎุงู ูุจูุบ ุจุฏู ุงูุฅุฌุงุฒุฉ** - handler ุงูุฑุณุงุฆู ูุง ูุณุชุฌูุจ.

## ๐ ุงูุณุจุจ:
ุชุฑุชูุจ ุชุณุฌูู ุงูู handlers ุฎุงุทุฆ - handlers ุงูุฑุณุงุฆู ูุฌุจ ุฃู ุชูุณุฌู ุจุชุฑุชูุจ ุตุญูุญ.

## โ ุงูุญู:
ุณุฃููู ุจุฅุนุงุฏุฉ ุชุฑุชูุจ handlers ูู ุงูููู ุงูุฑุฆูุณู:

---

ุงูุชุฑุชูุจ ูุจุฏู ุตุญูุญุงู - handlers ุงูุฑุณุงุฆู (postpone ู allowance) ูุณุฌูุฉ ุฃููุงู. ุงููุดููุฉ ูุฏ ุชููู ูู ุงูู handler ููุณู. ุฏุนูู ุฃุชุญูู ูู handler ุงูุจุฏู:

---

ุงููุดููุฉ ูุงุถุญุฉ! handler ุงูุฑุณุงุฆู ูุณุชุฎุฏู `await next()` ูู ุงูุจุฏุงูุฉุ ููู ุนูุฏ ุนุฏู ูุฌูุฏ `awaitingInput` ูุฌุจ ุฃู ููููู ุงูุชูููุฐ. ุงููุดููุฉ ุฃู ุงูู handler ูุชุญูู ูู ุงูุดุฑุท ููู ูุง ููููุฐ ุงูููุฏ ุจุนุฏู. ุฏุนูู ุฃุตูุญ ูุฐุง:

---

ุงูุขู ุฏุนูู ุฃุชุญูู ูู handler ุงูุชุฃุฌูู ุฃูุถุงู:

---

ููุณ ุงููุดููุฉ ูู handler ุงูุชุฃุฌูู. ุณุฃุตูุญู:

---

ููุชุงุฒ! ุงูุขู ุชู ุฅุตูุงุญ ุงููุดููุฉ ูู ููุง ุงูู handlers. ุงูุชุบููุฑ ุงูุฃุณุงุณู:

## โ ูุง ุชู ุฅุตูุงุญู:

**ูุจู:**
```typescript
if (ctx.session.awaitingInput?.type !== 'allowance_amount') {
  await next()
  return
}
```

**ุจุนุฏ:**
```typescript
if (!ctx.session.awaitingInput || ctx.session.awaitingInput.type !== 'allowance_amount') {
  return next()
}
```

**ุงููุฑู:**
- ุงูุขู ูุชู ุงุณุชุฏุนุงุก `next()` ูุจุงุดุฑุฉ ุจุฏูู `await` ูุฅุฑุฌุงุน ุงููุชูุฌุฉ
- ูุฐุง ูุณูุญ ููู handlers ุงูุฃุฎุฑู ุจูุนุงูุฌุฉ ุงูุฑุณุงูุฉ ุจุดูู ุตุญูุญ

ุงูุขู ุงูุจูุช ูุฌุจ ุฃู ูุนูู ุจุดูู ุตุญูุญ ุนูุฏ ุฅุฏุฎุงู ูุจูุบ ุงูุจุฏู ุฃู ุนุฏุฏ ุฃูุงู ุงูุชุฃุฌูู! ๐

---

ุฑุงุฆุน ูุนูู ุจุดูู ุฌูุฏ ุงูุงู
ุงุฑูุฏ ุงูุงู ุงูุบุงุก ุงุฒุฑุงุฑ ุตุฑู ุจุฏู ุงุฌุงุฒุงุฉ ูุชุฃุฌูู ุงุฌุงุฒุฉ ุงูููุฌูุฏูู ูู ุงููุงุฆูุฉ ุงูุฑุฆูุณูุฉ ููุงุฌุงุฒุงุช ุงุตุจุญูุง ุจุฏูู ุงูููุฉ ุงู ูุธููุฉ
๐๏ธ ุงูุฅุฌุงุฒุงุช ูุงููุฃููุฑูุงุช

ุงุฎุชุฑ ุงููุธููุฉ ุงููุทููุจุฉ:

๐ ุชุณุฌูู ุฅุฌุงุฒุฉ ุฌุฏูุฏุฉ

๐ ูุงุฆูุฉ ุงูุฅุฌุงุฒุงุช

โฉ๏ธ ุชุณุฌูู ุนูุฏุฉ

๐ ุฌุฏูู ุฃุฏูุงุฑ ุงูุฅุฌุงุฒุงุช

๐ค ุนุฑุถ ุฅุฌุงุฒุงุช ุนุงูู

โธ๏ธ ุชุฃุฌูู ุฅุฌุงุฒุฉ

๐ฐ ุตุฑู ุจุฏู ุฅุฌุงุฒุฉ

โ๏ธ ุงููุฃููุฑูุงุช

โฌ๏ธ ุฑุฌูุน

---

โ ุชู! ุงูุขู ุงููุงุฆูุฉ ุงูุฑุฆูุณูุฉ ููุฅุฌุงุฒุงุช ุฃุตุจุญุช:

**ูุจู:**
- ๐ ุชุณุฌูู ุฅุฌุงุฒุฉ ุฌุฏูุฏุฉ
- ๐ ูุงุฆูุฉ ุงูุฅุฌุงุฒุงุช | โฉ๏ธ ุชุณุฌูู ุนูุฏุฉ
- ๐ ุฌุฏูู ุฃุฏูุงุฑ ุงูุฅุฌุงุฒุงุช
- ๐ค ุนุฑุถ ุฅุฌุงุฒุงุช ุนุงูู
- โธ๏ธ ุชุฃุฌูู ุฅุฌุงุฒุฉ | ๐ฐ ุตุฑู ุจุฏู ุฅุฌุงุฒุฉ โ
- โ๏ธ ุงููุฃููุฑูุงุช
- โฌ๏ธ ุฑุฌูุน

**ุจุนุฏ:**
- ๐ ุชุณุฌูู ุฅุฌุงุฒุฉ ุฌุฏูุฏุฉ
- ๐ ูุงุฆูุฉ ุงูุฅุฌุงุฒุงุช | โฉ๏ธ ุชุณุฌูู ุนูุฏุฉ
- ๐ ุฌุฏูู ุฃุฏูุงุฑ ุงูุฅุฌุงุฒุงุช
- ๐ค ุนุฑุถ ุฅุฌุงุฒุงุช ุนุงูู
- โ๏ธ ุงููุฃููุฑูุงุช
- โฌ๏ธ ุฑุฌูุน

ุชู ุฅุฒุงูุฉ ุฃุฒุฑุงุฑ "ุชุฃุฌูู ุฅุฌุงุฒุฉ" ู "ุตุฑู ุจุฏู ุฅุฌุงุฒุฉ" ูู ุงููุงุฆูุฉ ุงูุฑุฆูุณูุฉ ูุฃูููุง ูุชุงุญุงู ุงูุขู ูู ุฏุงุฎู ุฌุฏูู ุฃุฏูุงุฑ ุงูุฅุฌุงุฒุงุช ุนูุฏ ุงุฎุชูุงุฑ ุนุงูู ูุญุฏุฏ.

---

ุฑุงุฆุน
ุงูุงู ุงุฑูุฏ ูุธุงู ุชุณุฌูู ุงููุฃููุฑูุงุช ูุงูุนูู ูู ุงูุฎุงุฑุฌ ุจููุณ ูููุฌูุฉ ูุชุฏููุงุช ุชุณุฌูู ุงูุงุฌุงุฒุงุช ุชูุงูุง
ูููุณ ุชูุงุฑูุฑ ุงูุนุฑุถ ููุนุงูููู
ุงุฑูุฏ ููุณ ุงููููุฌูุฉ  ุนูุฏ ุชุณุฌูู ุงููุงููุฑูุงุช ูุงูุนูู ูู ุงูุฎุงุฑุฌ
ุงุฑูุฏ ููู ูุฑุงุฌุนุฉ ุชูุซูู ุงูุงุฌุงุฒุงุช ูุงููุงููุฑูุงุช ููุนุฑูุฉ ุงููุชุทูุจุงุช ุจุดูู ูุงูู

---

ุณุฃุฑุงุฌุน ุชูุซูู ุงููุฃููุฑูุงุช ูููู ุงููุชุทูุจุงุช ุงููุงููุฉ:

---

ููุชุงุฒ! ุจุนุฏ ูุฑุงุฌุนุฉ ุงูุชูุซูู ููุงุนุฏุฉ ุงูุจูุงูุงุชุ ูุฏู ุตูุฑุฉ ูุงููุฉ ุนู ูุธุงู ุงููุฃููุฑูุงุช. ุณุฃูุดุฆ ูุธุงู ุงููุฃููุฑูุงุช ุจููุณ ูููุฌูุฉ ุงูุฅุฌุงุฒุงุช:

## ๐ ููุฎุต ุงููุชุทูุจุงุช:

### ุฌุฏูู `HR_EmployeeMission`:
- โ `missionNumber`: ุฑูู ุงููุฃููุฑูุฉ (ูุฑูุฏ)
- โ `missionType`: ููุน ุงููุฃููุฑูุฉ (TASK_EXECUTION ุฃู EXTERNAL_WORK)
- โ `startDate`, `endDate`, `totalDays`
- โ `location`, `purpose`
- โ `allowanceAmount`: ุงูุนูุฏุฉ ุงููุงููุฉ
- โ `actualReturnDate`: ุชุงุฑูุฎ ุงูุนูุฏุฉ ุงููุนูู
- โ `status`: ุญุงูุฉ ุงููุฃููุฑูุฉ

### ุงููุธุงุฆู ุงููุทููุจุฉ (ููุณ ูููุฌูุฉ ุงูุฅุฌุงุฒุงุช):
1. โ ุชุณุฌูู ูุฃููุฑูุฉ ุฌุฏูุฏุฉ
2. โ ูุงุฆูุฉ ุงููุฃููุฑูุงุช
3. โ ุชุณุฌูู ุนูุฏุฉ ูู ูุฃููุฑูุฉ
4. โ ุนุฑุถ ูุฃููุฑูุงุช ุนุงูู
5. โ ุฌุฏูู ุฃุฏูุงุฑ ุงููุฃููุฑูุงุช

ุณุฃุจุฏุฃ ุจุฅูุดุงุก ุงูู handlers:

---

ูุง ุงุฑูุฏ ุฌุฏูู ุฃุฏูุงุฑ ูุฃููุฑูุงุช 
ูุงููุงููุฑูุงุช ูู ููุนูู
ูุฃููุฑูุฉ ุงุงุฏุก ูููุฉ ุฎุงุฑุฌ ุงููููุน
ู ุงูุนูู ูู ุงูุฎุงุฑุฌ
ุงูุนูู ูู ุงูุฎุงุฑุฌ ูููู ุงู ุชููู ููุชูุญุฉ ุจุฏูู ุชุงุฑูุฎ ุนูุฏุฉ ุงู ุจุฏุงูุฉ ููููู ุชุณุฌูููุง ุงูุถุง

---

ูููุช ุชูุงูุงู! ุณุฃูุดุฆ ูุธุงู ุงููุฃููุฑูุงุช ุจุฏูู ุฌุฏูู ุฃุฏูุงุฑุ ูุน ููุนูู:

## ๐ ุงููุชุทูุจุงุช ุงูููุงุฆูุฉ:

### ุฃููุงุน ุงููุฃููุฑูุงุช:
1. **ูุฃููุฑูุฉ ุฃุฏุงุก ูููุฉ ุฎุงุฑุฌ ุงููููุน** (TASK_EXECUTION):
   - ููุง ุชุงุฑูุฎ ุจุฏุงูุฉ ูููุงูุฉ ูุญุฏุฏ
   - ูุชู ุชุณุฌูู ุงูุนูุฏุฉ

2. **ุงูุนูู ูู ุงูุฎุงุฑุฌ** (EXTERNAL_WORK):
   - ูููู ุฃู ุชููู ููุชูุญุฉ (ุจุฏูู ุชุงุฑูุฎ ููุงูุฉ)
   - ูููู ุชุณุฌูููุง ูู ุฃู ููุช

### ุงููุธุงุฆู ุงููุทููุจุฉ:
1. โ ุชุณุฌูู ูุฃููุฑูุฉ ุฌุฏูุฏุฉ (ููุนูู)
2. โ ูุงุฆูุฉ ุงููุฃููุฑูุงุช
3. โ ุชุณุฌูู ุนูุฏุฉ ูู ูุฃููุฑูุฉ
4. โ ุนุฑุถ ูุฃููุฑูุงุช ุนุงูู

ุณุฃุจุฏุฃ ุงูุขู:

---

ุฅูุดุงุก handler ุงููุงุฆูุฉ ุงูุฑุฆูุณูุฉ ูููุฃููุฑูุงุช ูุน 4 ูุธุงุฆู ููุท (ุจุฏูู ุฌุฏูู ุฃุฏูุงุฑ)

---

ุชุณุฌูู handler ุงููุฃููุฑูุงุช ูู ุงูููู ุงูุฑุฆูุณู

---

โ ุชู! ุงูุขู ุงููุงุฆูุฉ ุงูุฑุฆูุณูุฉ ูููุฃููุฑูุงุช ุฌุงูุฒุฉ ูุน:

**ุงููุธุงุฆู:**
- ๐ ุชุณุฌูู ูุฃููุฑูุฉ ุฌุฏูุฏุฉ (ุณูุฏุนู ุงูููุนูู)
- ๐ ูุงุฆูุฉ ุงููุฃููุฑูุงุช
- โฉ๏ธ ุชุณุฌูู ุนูุฏุฉ ูู ูุฃููุฑูุฉ
- ๐ค ุนุฑุถ ูุฃููุฑูุงุช ุนุงูู
- โฌ๏ธ ุฑุฌูุน

**ุจุฏูู:**
- โ ุฌุฏูู ุฃุฏูุงุฑ ุงููุฃููุฑูุงุช (ุชู ุฅุฒุงูุชู)

ุงูุขู ููููู ุงุฎุชุจุงุฑ ุงููุงุฆูุฉุ ูุณุฃุจุฏุฃ ุจุชุทููุฑ ุงููุธุงุฆู ุงูุฃุฑุจุนุฉ ุจููุณ ูููุฌูุฉ ุงูุฅุฌุงุฒุงุช. ูู ุชุฑูุฏ ุงูุจุฏุก ุจุชุณุฌูู ูุฃููุฑูุฉ ุฌุฏูุฏุฉุ

---

โ๏ธ ุงููุฃููุฑูุงุช

โณ ุงููุธููุฉ ููุฏ ุงูุชุทููุฑ...

---

ุงููุดููุฉ ุฃู handler ุงููุฃููุฑูุงุช ูู ูุชู ุชุณุฌููู ุจุดูู ุตุญูุญ. ุฏุนูู ุฃุตูุญ ุฐูู:

---

ุฅุฒุงูุฉ handler ุงููุฃููุฑูุงุช ุงููุคูุช ูู leaves.handler.ts ูุฃูู ููุฌูุฏ ุงูุขู ูู missions.handler.ts